<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="assets/resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="assets/resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="assets/resources/config.js"></script>
<script type="text/javascript" src="assets/resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Safety</h1>

<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab91"></a><h1 class="section">Type Soundness</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Coq.Program.Equality</span> <span class="id" title="library">List</span> <span class="id" title="library">String</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Sequences.html#"><span class="id" title="library">Sequences</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Binding.html#"><span class="id" title="library">Binding</span></a> <a class="idref" href="CanonicalForms.html#"><span class="id" title="library">CanonicalForms</span></a> <a class="idref" href="Definitions.html#"><span class="id" title="library">Definitions</span></a> <a class="idref" href="GeneralToTight.html#"><span class="id" title="library">GeneralToTight</span></a> <a class="idref" href="InvertibleTyping.html#"><span class="id" title="library">InvertibleTyping</span></a> <a class="idref" href="Lookup.html#"><span class="id" title="library">Lookup</span></a> <a class="idref" href="Narrowing.html#"><span class="id" title="library">Narrowing</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Reduction.html#"><span class="id" title="library">Reduction</span></a> <a class="idref" href="PreciseTyping.html#"><span class="id" title="library">PreciseTyping</span></a> <a class="idref" href="RecordAndInertTypes.html#"><span class="id" title="library">RecordAndInertTypes</span></a> <a class="idref" href="ReplacementTyping.html#"><span class="id" title="library">ReplacementTyping</span></a> <a class="idref" href="Replacement.html#"><span class="id" title="library">Replacement</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Subenvironments.html#"><span class="id" title="library">Subenvironments</span></a> <a class="idref" href="Substitution.html#"><span class="id" title="library">Substitution</span></a> <a class="idref" href="TightTyping.html#"><span class="id" title="library">TightTyping</span></a> <a class="idref" href="Weakening.html#"><span class="id" title="library">Weakening</span></a>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab92"></a><h2 class="section">Safety wrt Term Reduction ⟼</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a id="Safety" class="idref" href="#Safety"><span class="id" title="section">Safety</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab93"></a><h3 class="section">Reasoning about the precise type of objects</h3>

<div class="paragraph"> </div>

 If the rhs of a type declaration is a signleton type <span class="inlinecode"><span class="id" title="var">q.type</span></span> then
    <span class="inlinecode"><span class="id" title="var">q</span></span> is well-typed 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="defs_typing_sngl_rhs" class="idref" href="#defs_typing_sngl_rhs"><span class="id" title="lemma">defs_typing_sngl_rhs</span></a> <a id="z:1" class="idref" href="#z:1"><span class="id" title="binder">z</span></a> <a id="bs:2" class="idref" href="#bs:2"><span class="id" title="binder">bs</span></a> <a id="G:3" class="idref" href="#G:3"><span class="id" title="binder">G</span></a> <a id="ds:4" class="idref" href="#ds:4"><span class="id" title="binder">ds</span></a> <a id="T:5" class="idref" href="#T:5"><span class="id" title="binder">T</span></a> <a id="a:6" class="idref" href="#a:6"><span class="id" title="binder">a</span></a> <a id="q:7" class="idref" href="#q:7"><span class="id" title="binder">q</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:1"><span class="id" title="variable">z</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#bs:2"><span class="id" title="variable">bs</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#G:3"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#ds:4"><span class="id" title="variable">ds</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">::</span></a> <a class="idref" href="Safety.html#T:5"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> <a class="idref" href="Safety.html#T:5"><span class="id" title="variable">T</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#a:6"><span class="id" title="variable">a</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">{{</span></a> <a class="idref" href="Safety.html#q:7"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">}}</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="T:8" class="idref" href="#T:8"><span class="id" title="binder">T</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#G:3"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#q:7"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:8"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">D</span>; <span class="id" title="var">inversions</span> <span class="id" title="var">Hr</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">inversions</span> <span class="id" title="var">Hr</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">H5</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">lookup_fields_typ</span></span> notation <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">T</span></span> <span class="inlinecode">=<span class="id" title="var">bs</span>⇒</span> <span class="inlinecode"><span class="id" title="var">U</span></span> denotes that
    if <span class="inlinecode"><span class="id" title="var">T</span></span> is a recursive type then we can "look up" or "go down" a path
    <span class="inlinecode"><span class="id" title="var">x.bs</span></span> inside of <span class="inlinecode"><span class="id" title="var">T</span></span> yielding a type <span class="inlinecode"><span class="id" title="var">U</span></span>. For example, if
    <span class="inlinecode"><span class="id" title="var">T</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">μ</span>(<span class="id" title="var">x</span>:</span> <span class="inlinecode">{<span class="id" title="var">a</span>:</span> <span class="inlinecode"><span class="id" title="var">μ</span>(<span class="id" title="var">y</span>:</span> <span class="inlinecode">{<span class="id" title="var">b</span>:</span> <span class="inlinecode"><span class="id" title="var">μ</span>(<span class="id" title="var">z</span>:</span> <span class="inlinecode">⊤)})})</span> then
    <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">T</span></span> <span class="inlinecode">=<span class="id" title="var">b</span>,<span class="id" title="var">a</span>=&gt;⊤</span> 
</div>
<div class="code">
<span class="id" title="keyword">Reserved Notation</span> &quot;x '==&gt;' T '=' bs '=&gt;' U" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="var">T</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20).<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">T</span></span> <span class="inlinecode">=<span class="id" title="var">bs</span>⇒</span> <span class="inlinecode"><span class="id" title="var">U</span></span> we will say that looking up the path
    <span class="inlinecode"><span class="id" title="var">x.bs</span></span> in <span class="inlinecode"><span class="id" title="var">T</span></span> yields <span class="inlinecode"><span class="id" title="var">U</span></span>.
</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <a id="lookup_fields_typ" class="idref" href="#lookup_fields_typ"><span class="id" title="inductive">lookup_fields_typ</span></a> : <span class="id" title="axiom">var</span> <span class="id" title="notation">→</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a> <span class="id" title="notation">→</span> <span class="id" title="inductive">list</span> <a class="idref" href="Definitions.html#trm_label"><span class="id" title="axiom">trm_label</span></a> <span class="id" title="notation">→</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a> <span class="id" title="notation">→</span> <span class="id" title="keyword">Prop</span> :=<br/>
| <a id="lft_empty" class="idref" href="#lft_empty"><span class="id" title="constructor">lft_empty</span></a> : <span class="id" title="keyword">∀</span> <a id="x:11" class="idref" href="#x:11"><span class="id" title="binder">x</span></a> <a id="T:12" class="idref" href="#T:12"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#x:11"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#T:12"><span class="id" title="variable">T</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><span class="id" title="constructor">nil</span><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Safety.html#T:12"><span class="id" title="variable">T</span></a><br/>
| <a id="lft_cons" class="idref" href="#lft_cons"><span class="id" title="constructor">lft_cons</span></a> : <span class="id" title="keyword">∀</span> <a id="T:13" class="idref" href="#T:13"><span class="id" title="binder">T</span></a> <a id="bs:14" class="idref" href="#bs:14"><span class="id" title="binder">bs</span></a> <a id="U:15" class="idref" href="#U:15"><span class="id" title="binder">U</span></a> <a id="x:16" class="idref" href="#x:16"><span class="id" title="binder">x</span></a> <a id="a:17" class="idref" href="#a:17"><span class="id" title="binder">a</span></a> <a id="S:18" class="idref" href="#S:18"><span class="id" title="binder">S</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#x:16"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#T:13"><span class="id" title="variable">T</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:14"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#U:15"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> (<a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#x:16"><span class="id" title="variable">x</span></a>) <a class="idref" href="Safety.html#bs:14"><span class="id" title="variable">bs</span></a>) <a class="idref" href="Safety.html#U:15"><span class="id" title="variable">U</span></a>) <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#a:17"><span class="id" title="variable">a</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Safety.html#S:18"><span class="id" title="variable">S</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#x:16"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#T:13"><span class="id" title="variable">T</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#a:17"><span class="id" title="variable">a</span></a><span class="id" title="notation">::</span><a class="idref" href="Safety.html#bs:14"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Safety.html#S:18"><span class="id" title="variable">S</span></a><br/>
<br/>
<span class="id" title="keyword">where</span> <a id="2c94547ea97c5c3e346ee66431009735" class="idref" href="#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">&quot;</span></a>x '==&gt;' T '=' bs '=&gt;' U" := (<a class="idref" href="Safety.html#lookup_fields_typ:10"><span class="id" title="inductive">lookup_fields_typ</span></a> <span class="id" title="var">x</span> <span class="id" title="var">T</span> <span class="id" title="var">bs</span> <span class="id" title="var">U</span>).<br/>

<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Safety.html#lookup_fields_typ"><span class="id" title="inductive">lookup_fields_typ</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab94"></a><h4 class="section">Properties of <span class="inlinecode"><span class="id" title="var">lookup_fields_typ</span></span></h4>

<div class="paragraph"> </div>

 Looking up a path inside of an inert type yields an inert type 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lft_inert" class="idref" href="#lft_inert"><span class="id" title="lemma">lft_inert</span></a> <a id="x:19" class="idref" href="#x:19"><span class="id" title="binder">x</span></a> <a id="T:20" class="idref" href="#T:20"><span class="id" title="binder">T</span></a> <a id="bs:21" class="idref" href="#bs:21"><span class="id" title="binder">bs</span></a> <a id="U:22" class="idref" href="#U:22"><span class="id" title="binder">U</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#T:20"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:19"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#T:20"><span class="id" title="variable">T</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:21"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#U:22"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> (<a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#U:22"><span class="id" title="variable">U</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hl</span>. <span class="id" title="var">gen</span> <span class="id" title="var">x</span> <span class="id" title="var">U</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">bs</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hl</span>; <span class="id" title="var">inversions</span> <span class="id" title="var">Hl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHbs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H3</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="RecordAndInertTypes.html#inert_record_has"><span class="id" title="lemma">inert_record_has</span></a> <span class="id" title="var">_</span> <span class="id" title="var">IHbs</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hin</span> | [? [=]]]. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">lookup_fields_typ</span></span> relation is functional. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lft_unique" class="idref" href="#lft_unique"><span class="id" title="lemma">lft_unique</span></a> <a id="x:23" class="idref" href="#x:23"><span class="id" title="binder">x</span></a> <a id="S:24" class="idref" href="#S:24"><span class="id" title="binder">S</span></a> <a id="bs:25" class="idref" href="#bs:25"><span class="id" title="binder">bs</span></a> <a id="T:26" class="idref" href="#T:26"><span class="id" title="binder">T</span></a> <a id="U:27" class="idref" href="#U:27"><span class="id" title="binder">U</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#S:24"><span class="id" title="variable">S</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:23"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:24"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:25"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Safety.html#T:26"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:23"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:24"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:25"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Safety.html#U:27"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#T:26"><span class="id" title="variable">T</span></a> <span class="id" title="notation">=</span> <a class="idref" href="Safety.html#U:27"><span class="id" title="variable">U</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hl1</span>. <span class="id" title="var">gen</span> <span class="id" title="var">U</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">Hl1</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hl2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hl2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">inversions</span> <span class="id" title="var">Hl2</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHl1</span> <span class="id" title="var">Hi</span> <span class="id" title="var">_</span> <span class="id" title="var">H4</span>) <span class="id" title="keyword">as</span> [= -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_inert"><span class="id" title="lemma">lft_inert</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hl1</span>). <span class="id" title="var">inversions</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="RecordAndInertTypes.html#unique_rcd_trm"><span class="id" title="lemma">unique_rcd_trm</span></a>. <span class="id" title="tactic">apply</span>× <a class="idref" href="RecordAndInertTypes.html#open_record_type_p"><span class="id" title="lemma">open_record_type_p</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If looking up a path in <span class="inlinecode"><span class="id" title="var">T</span></span> yields a function type then we cannot
    look up a longer path in <span class="inlinecode"><span class="id" title="var">T</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lft_typ_all_inv" class="idref" href="#lft_typ_all_inv"><span class="id" title="lemma">lft_typ_all_inv</span></a> <a id="x:28" class="idref" href="#x:28"><span class="id" title="binder">x</span></a> <a id="S:29" class="idref" href="#S:29"><span class="id" title="binder">S</span></a> <a id="bs:30" class="idref" href="#bs:30"><span class="id" title="binder">bs</span></a> <a id="cs:31" class="idref" href="#cs:31"><span class="id" title="binder">cs</span></a> <a id="V:32" class="idref" href="#V:32"><span class="id" title="binder">V</span></a> <a id="T:33" class="idref" href="#T:33"><span class="id" title="binder">T</span></a> <a id="U:34" class="idref" href="#U:34"><span class="id" title="binder">U</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#S:29"><span class="id" title="variable">S</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:28"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:29"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:30"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">∀(</span></a><a class="idref" href="Safety.html#T:33"><span class="id" title="variable">T</span></a><a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">)</span></a> <a class="idref" href="Safety.html#U:34"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:28"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:29"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#cs:31"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#bs:30"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Safety.html#V:32"><span class="id" title="variable">V</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#cs:31"><span class="id" title="variable">cs</span></a> <span class="id" title="notation">=</span> <span class="id" title="constructor">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">gen</span> <span class="id" title="var">x</span> <span class="id" title="var">S</span> <span class="id" title="var">bs</span> <span class="id" title="var">T</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">app_comm_cons</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">Hl2</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHcs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_unique"><span class="id" title="lemma">lft_unique</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> [= &lt;-].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If looking up a path in <span class="inlinecode"><span class="id" title="var">T</span></span> yields a singleton type then we cannot
    look up a longer path in <span class="inlinecode"><span class="id" title="var">T</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lft_typ_sngl_inv" class="idref" href="#lft_typ_sngl_inv"><span class="id" title="lemma">lft_typ_sngl_inv</span></a> <a id="x:35" class="idref" href="#x:35"><span class="id" title="binder">x</span></a> <a id="S:36" class="idref" href="#S:36"><span class="id" title="binder">S</span></a> <a id="bs:37" class="idref" href="#bs:37"><span class="id" title="binder">bs</span></a> <a id="p:38" class="idref" href="#p:38"><span class="id" title="binder">p</span></a> <a id="cs:39" class="idref" href="#cs:39"><span class="id" title="binder">cs</span></a> <a id="V:40" class="idref" href="#V:40"><span class="id" title="binder">V</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#S:36"><span class="id" title="variable">S</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:35"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:36"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:37"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">{{</span></a> <a class="idref" href="Safety.html#p:38"><span class="id" title="variable">p</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">}}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:35"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:36"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#cs:39"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#bs:37"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Safety.html#V:40"><span class="id" title="variable">V</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#cs:39"><span class="id" title="variable">cs</span></a> <span class="id" title="notation">=</span> <span class="id" title="constructor">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">gen</span> <span class="id" title="var">x</span> <span class="id" title="var">S</span> <span class="id" title="var">bs</span> <span class="id" title="var">p</span> <span class="id" title="var">V</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">app_comm_cons</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">Hl2</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHcs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_unique"><span class="id" title="lemma">lft_unique</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> [= &lt;-].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the definitions <span class="inlinecode"><span class="id" title="var">ds</span></span> that correspond to a path <span class="inlinecode"><span class="id" title="var">p</span></span> (here, <span class="inlinecode"><span class="id" title="var">z.bs</span></span>)
    have a type <span class="inlinecode"><span class="id" title="var">T</span>ᵖ</span>, and looking up the path <span class="inlinecode"><span class="id" title="var">x.cs</span></span> for some <span class="inlinecode"><span class="id" title="var">x</span></span>
    in <span class="inlinecode"><span class="id" title="var">T</span>ᵖ</span> yields a type <span class="inlinecode"><span class="id" title="var">μ</span>(<span class="id" title="var">U</span>)</span> then nested in <span class="inlinecode"><span class="id" title="var">ds</span></span> are some definitions
    <span class="inlinecode"><span class="id" title="var">ds'</span></span> such that under the path <span class="inlinecode"><span class="id" title="var">p.cs</span></span>, <span class="inlinecode"><span class="id" title="var">ds'</span></span> can be typed with <span class="inlinecode"><span class="id" title="var">U</span></span><sup>p.cs</sup>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lfs_defs_typing" class="idref" href="#lfs_defs_typing"><span class="id" title="lemma">lfs_defs_typing</span></a> : <span class="id" title="keyword">∀</span> <a id="cs:41" class="idref" href="#cs:41"><span class="id" title="binder">cs</span></a> <a id="z:42" class="idref" href="#z:42"><span class="id" title="binder">z</span></a> <a id="bs:43" class="idref" href="#bs:43"><span class="id" title="binder">bs</span></a> <a id="G:44" class="idref" href="#G:44"><span class="id" title="binder">G</span></a> <a id="ds:45" class="idref" href="#ds:45"><span class="id" title="binder">ds</span></a> <a id="T:46" class="idref" href="#T:46"><span class="id" title="binder">T</span></a> <a id="S:47" class="idref" href="#S:47"><span class="id" title="binder">S</span></a> <a id="U:48" class="idref" href="#U:48"><span class="id" title="binder">U</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:42"><span class="id" title="variable">z</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#bs:43"><span class="id" title="variable">bs</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#G:44"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#ds:45"><span class="id" title="variable">ds</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">::</span></a> <a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#z:42"><span class="id" title="variable">z</span></a>) <a class="idref" href="Safety.html#bs:43"><span class="id" title="variable">bs</span></a>) <a class="idref" href="Safety.html#T:46"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#S:47"><span class="id" title="variable">S</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:42"><span class="id" title="variable">z</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:47"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:43"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#T:46"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:42"><span class="id" title="variable">z</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:47"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#cs:41"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#bs:43"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#U:48"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="ds':49" class="idref" href="#ds':49"><span class="id" title="binder">ds'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#z:42"><span class="id" title="variable">z</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">(</span></a><a class="idref" href="Safety.html#cs:41"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#bs:43"><span class="id" title="variable">bs</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">);</span></a> <a class="idref" href="Safety.html#G:44"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#ds':49"><span class="id" title="variable">ds'</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">::</span></a> <a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#z:42"><span class="id" title="variable">z</span></a>) (<a class="idref" href="Safety.html#cs:41"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#bs:43"><span class="id" title="variable">bs</span></a>)) <a class="idref" href="Safety.html#U:48"><span class="id" title="variable">U</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hds</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_l</span> <span class="id" title="tactic">in</span>×. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_unique"><span class="id" title="lemma">lft_unique</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>) <span class="id" title="keyword">as</span> [= -&gt;]. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">app_comm_cons</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">inversions</span> <span class="id" title="var">Hl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHcs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hds</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">ds'</span> <span class="id" title="var">Hds'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Binding.html#record_has_ty_defs"><span class="id" title="lemma">record_has_ty_defs</span></a> <span class="id" title="var">Hds'</span> <span class="id" title="var">H5</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">d</span> [<span class="id" title="var">Hdh</span> <span class="id" title="var">Hd</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">Hd</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Suppose the declaration <span class="inlinecode"><span class="id" title="var">d</span></span> corresponding to a path <span class="inlinecode"><span class="id" title="var">z.bs</span></span>
    has type <span class="inlinecode">{<span class="id" title="var">b</span>:</span> <span class="inlinecode"><span class="id" title="var">V</span>}</span>, and that <span class="inlinecode"><span class="id" title="var">V</span>=...∧</span> <span class="inlinecode">{<span class="id" title="var">a</span>:</span> <span class="inlinecode"><span class="id" title="var">q.type</span>}</span> <span class="inlinecode">∧...</span>.
    Then <span class="inlinecode"><span class="id" title="var">q</span></span> is well-typed.
    
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="def_typing_rhs" class="idref" href="#def_typing_rhs"><span class="id" title="lemma">def_typing_rhs</span></a> <a id="z:50" class="idref" href="#z:50"><span class="id" title="binder">z</span></a> <a id="bs:51" class="idref" href="#bs:51"><span class="id" title="binder">bs</span></a> <a id="G:52" class="idref" href="#G:52"><span class="id" title="binder">G</span></a> <a id="d:53" class="idref" href="#d:53"><span class="id" title="binder">d</span></a> <a id="a:54" class="idref" href="#a:54"><span class="id" title="binder">a</span></a> <a id="q:55" class="idref" href="#q:55"><span class="id" title="binder">q</span></a> <a id="U:56" class="idref" href="#U:56"><span class="id" title="binder">U</span></a> <a id="S:57" class="idref" href="#S:57"><span class="id" title="binder">S</span></a> <a id="cs:58" class="idref" href="#cs:58"><span class="id" title="binder">cs</span></a> <a id="T:59" class="idref" href="#T:59"><span class="id" title="binder">T</span></a> <a id="b:60" class="idref" href="#b:60"><span class="id" title="binder">b</span></a> <a id="V:61" class="idref" href="#V:61"><span class="id" title="binder">V</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:50"><span class="id" title="variable">z</span></a><a class="idref" href="Definitions.html#ae7a57a11402d7c5d6d3a8914fe4ced3"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#bs:51"><span class="id" title="variable">bs</span></a><a class="idref" href="Definitions.html#ae7a57a11402d7c5d6d3a8914fe4ced3"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#G:52"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#ae7a57a11402d7c5d6d3a8914fe4ced3"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#d:53"><span class="id" title="variable">d</span></a> <a class="idref" href="Definitions.html#ae7a57a11402d7c5d6d3a8914fe4ced3"><span class="id" title="notation">:</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#b:60"><span class="id" title="variable">b</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Safety.html#V:61"><span class="id" title="variable">V</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#S:57"><span class="id" title="variable">S</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:50"><span class="id" title="variable">z</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:57"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:51"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#T:59"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> (<a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#z:50"><span class="id" title="variable">z</span></a>) <a class="idref" href="Safety.html#bs:51"><span class="id" title="variable">bs</span></a>) <a class="idref" href="Safety.html#T:59"><span class="id" title="variable">T</span></a>) <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#b:60"><span class="id" title="variable">b</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Safety.html#V:61"><span class="id" title="variable">V</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:50"><span class="id" title="variable">z</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:57"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#cs:58"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#b:60"><span class="id" title="variable">b</span></a><span class="id" title="notation">::</span><a class="idref" href="Safety.html#bs:51"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#U:56"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> (<a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#z:50"><span class="id" title="variable">z</span></a>) (<a class="idref" href="Safety.html#cs:58"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#b:60"><span class="id" title="variable">b</span></a><span class="id" title="notation">::</span><a class="idref" href="Safety.html#bs:51"><span class="id" title="variable">bs</span></a>)) <a class="idref" href="Safety.html#U:56"><span class="id" title="variable">U</span></a>) <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#a:54"><span class="id" title="variable">a</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">{{</span></a> <a class="idref" href="Safety.html#q:55"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">}}</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="W:62" class="idref" href="#W:62"><span class="id" title="binder">W</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#G:52"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#q:55"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#W:62"><span class="id" title="variable">W</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hds</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hrd</span> <span class="id" title="var">Hl2</span> <span class="id" title="var">Hr</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">Hds</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "def_all"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#lft_cons"><span class="id" title="constructor">lft_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_typ_all_inv"><span class="id" title="lemma">lft_typ_all_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>) <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_l</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_unique"><span class="id" title="lemma">lft_unique</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>) <span class="id" title="keyword">as</span> [=].<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "def_new"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Definitions.html#ty_def_new"><span class="id" title="constructor">ty_def_new</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="constructor">eq_refl</span> <span class="id" title="var">H2</span> <span class="id" title="var">H7</span> <span class="id" title="var">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">z</span> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <span class="id" title="var">S</span> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><span class="id" title="var">b</span><span class="id" title="notation">::</span><span class="id" title="var">bs</span><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <span class="id" title="var">T0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hl1'</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#lft_cons"><span class="id" title="constructor">lft_cons</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lfs_defs_typing"><span class="id" title="lemma">lfs_defs_typing</span></a> <span class="id" title="var">_</span> <span class="id" title="var">H7</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1'</span> <span class="id" title="var">Hl2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">ds'</span> <span class="id" title="var">Hds'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Binding.html#record_has_ty_defs"><span class="id" title="lemma">record_has_ty_defs</span></a> <span class="id" title="var">Hds'</span> <span class="id" title="var">Hr</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">d</span> [<span class="id" title="var">Hdh</span> <span class="id" title="var">Hd</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">Hd</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "def_path"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#lft_cons"><span class="id" title="constructor">lft_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_typ_sngl_inv"><span class="id" title="lemma">lft_typ_sngl_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>) <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_l</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#lft_unique"><span class="id" title="lemma">lft_unique</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>) <span class="id" title="keyword">as</span> [=].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The same applies to the case where we type multiple declarations that contain
    <span class="inlinecode">{<span class="id" title="var">b</span>:</span> <span class="inlinecode"><span class="id" title="var">V</span>}</span> as a record. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="defs_typing_rhs" class="idref" href="#defs_typing_rhs"><span class="id" title="lemma">defs_typing_rhs</span></a> <a id="z:63" class="idref" href="#z:63"><span class="id" title="binder">z</span></a> <a id="bs:64" class="idref" href="#bs:64"><span class="id" title="binder">bs</span></a> <a id="G:65" class="idref" href="#G:65"><span class="id" title="binder">G</span></a> <a id="ds:66" class="idref" href="#ds:66"><span class="id" title="binder">ds</span></a> <a id="T:67" class="idref" href="#T:67"><span class="id" title="binder">T</span></a> <a id="a:68" class="idref" href="#a:68"><span class="id" title="binder">a</span></a> <a id="q:69" class="idref" href="#q:69"><span class="id" title="binder">q</span></a> <a id="U:70" class="idref" href="#U:70"><span class="id" title="binder">U</span></a> <a id="S:71" class="idref" href="#S:71"><span class="id" title="binder">S</span></a> <a id="cs:72" class="idref" href="#cs:72"><span class="id" title="binder">cs</span></a> <a id="T':73" class="idref" href="#T':73"><span class="id" title="binder">T'</span></a> <a id="b:74" class="idref" href="#b:74"><span class="id" title="binder">b</span></a> <a id="V:75" class="idref" href="#V:75"><span class="id" title="binder">V</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:63"><span class="id" title="variable">z</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#bs:64"><span class="id" title="variable">bs</span></a><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <a class="idref" href="Safety.html#G:65"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#ds:66"><span class="id" title="variable">ds</span></a> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">::</span></a> <a class="idref" href="Safety.html#T:67"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#S:71"><span class="id" title="variable">S</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:63"><span class="id" title="variable">z</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:71"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs:64"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#T':73"><span class="id" title="variable">T'</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> (<a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#z:63"><span class="id" title="variable">z</span></a>) <a class="idref" href="Safety.html#bs:64"><span class="id" title="variable">bs</span></a>) <a class="idref" href="Safety.html#T':73"><span class="id" title="variable">T'</span></a>) <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#b:74"><span class="id" title="variable">b</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Safety.html#V:75"><span class="id" title="variable">V</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> <a class="idref" href="Safety.html#T:67"><span class="id" title="variable">T</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#b:74"><span class="id" title="variable">b</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Safety.html#V:75"><span class="id" title="variable">V</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#z:63"><span class="id" title="variable">z</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#S:71"><span class="id" title="variable">S</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#cs:72"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#b:74"><span class="id" title="variable">b</span></a><span class="id" title="notation">::</span><a class="idref" href="Safety.html#bs:64"><span class="id" title="variable">bs</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#U:70"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> (<a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#z:63"><span class="id" title="variable">z</span></a>) (<a class="idref" href="Safety.html#cs:72"><span class="id" title="variable">cs</span></a><span class="id" title="notation">++</span><a class="idref" href="Safety.html#b:74"><span class="id" title="variable">b</span></a><span class="id" title="notation">::</span><a class="idref" href="Safety.html#bs:64"><span class="id" title="variable">bs</span></a>)) <a class="idref" href="Safety.html#U:70"><span class="id" title="variable">U</span></a>) <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#a:68"><span class="id" title="variable">a</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">{{</span></a> <a class="idref" href="Safety.html#q:69"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">}}</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="V:76" class="idref" href="#V:76"><span class="id" title="binder">V</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#G:65"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#q:69"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#V:76"><span class="id" title="variable">V</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hds</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span> <span class="id" title="var">Hl2</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">gen</span> <span class="id" title="var">S</span> <span class="id" title="var">a</span> <span class="id" title="var">q</span> <span class="id" title="var">U</span> <span class="id" title="var">cs</span> <span class="id" title="var">T'</span> <span class="id" title="var">b</span> <span class="id" title="var">V</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">Hds</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hin</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hl1</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hl2</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">inversions</span> <span class="id" title="var">Hr2</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#def_typing_rhs"><span class="id" title="lemma">def_typing_rhs</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHds</span> <span class="id" title="var">_</span> <span class="id" title="var">Hin</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hl1</span> <span class="id" title="var">_</span> <span class="id" title="var">Hl2</span> <span class="id" title="var">Hr</span> <span class="id" title="var">_</span> <span class="id" title="var">Hr1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">Hr2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">IHHds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#def_typing_rhs"><span class="id" title="lemma">def_typing_rhs</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Looking up a path inside of a variable <span class="inlinecode"><span class="id" title="var">x</span></span>'s environment type,
    given that we can type the path <span class="inlinecode"><span class="id" title="var">x.bs</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="pf_sngl_to_lft" class="idref" href="#pf_sngl_to_lft"><span class="id" title="lemma">pf_sngl_to_lft</span></a> <a id="G:77" class="idref" href="#G:77"><span class="id" title="binder">G</span></a> <a id="x:78" class="idref" href="#x:78"><span class="id" title="binder">x</span></a> <a id="T:79" class="idref" href="#T:79"><span class="id" title="binder">T</span></a> <a id="bs:80" class="idref" href="#bs:80"><span class="id" title="binder">bs</span></a> <a id="W:81" class="idref" href="#W:81"><span class="id" title="binder">W</span></a> <a id="V:82" class="idref" href="#V:82"><span class="id" title="binder">V</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> (<a class="idref" href="Safety.html#G:77"><span class="id" title="variable">G</span></a> <span class="id" title="notation">&amp;</span> <a class="idref" href="Safety.html#x:78"><span class="id" title="variable">x</span></a> <span class="id" title="notation">~</span> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#T:79"><span class="id" title="variable">T</span></a>) <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#G:77"><span class="id" title="variable">G</span></a> <span class="id" title="notation">&amp;</span> <a class="idref" href="Safety.html#x:78"><span class="id" title="variable">x</span></a> <span class="id" title="notation">~</span> <span class="id" title="notation">(</span><a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#T:79"><span class="id" title="variable">T</span></a><span class="id" title="notation">)</span> <a class="idref" href="PreciseFlow.html#27d10efae8295170a08832205c915493"><span class="id" title="notation">⊢!</span></a> <a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#x:78"><span class="id" title="variable">x</span></a>) <a class="idref" href="Safety.html#bs:80"><span class="id" title="variable">bs</span></a> <a class="idref" href="PreciseFlow.html#27d10efae8295170a08832205c915493"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#W:81"><span class="id" title="variable">W</span></a> <a class="idref" href="PreciseFlow.html#27d10efae8295170a08832205c915493"><span class="id" title="notation">⪼</span></a> <a class="idref" href="Safety.html#V:82"><span class="id" title="variable">V</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#bs:80"><span class="id" title="variable">bs</span></a> <span class="id" title="notation">=</span> <span class="id" title="constructor">nil</span> <span class="id" title="notation">∨</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="b:83" class="idref" href="#b:83"><span class="id" title="binder">b</span></a> <a id="c:84" class="idref" href="#c:84"><span class="id" title="binder">c</span></a> <a id="bs':85" class="idref" href="#bs':85"><span class="id" title="binder">bs'</span></a> <a id="bs'':86" class="idref" href="#bs'':86"><span class="id" title="binder">bs''</span></a> <a id="U:87" class="idref" href="#U:87"><span class="id" title="binder">U</span></a> <a id="V:88" class="idref" href="#V:88"><span class="id" title="binder">V</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#bs:80"><span class="id" title="variable">bs</span></a> <span class="id" title="notation">=</span> <a class="idref" href="Safety.html#c:84"><span class="id" title="variable">c</span></a> <span class="id" title="notation">::</span> <a class="idref" href="Safety.html#bs':85"><span class="id" title="variable">bs'</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#bs:80"><span class="id" title="variable">bs</span></a> <span class="id" title="notation">=</span> <a class="idref" href="Safety.html#bs'':86"><span class="id" title="variable">bs''</span></a> <span class="id" title="notation">++</span> <a class="idref" href="Safety.html#b:83"><span class="id" title="variable">b</span></a> <span class="id" title="notation">::</span> <span class="id" title="constructor">nil</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#x:78"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">(</span></a><a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#T:79"><span class="id" title="variable">T</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">)</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">=</span></a><a class="idref" href="Safety.html#bs':85"><span class="id" title="variable">bs'</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">(</span></a><a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <a class="idref" href="Safety.html#U:87"><span class="id" title="variable">U</span></a><a class="idref" href="Safety.html#2c94547ea97c5c3e346ee66431009735"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> (<a class="idref" href="Definitions.html#open_typ"><span class="id" title="definition">open_typ</span></a> <a class="idref" href="Safety.html#x:78"><span class="id" title="variable">x</span></a> <a class="idref" href="Safety.html#T:79"><span class="id" title="variable">T</span></a>) <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#b:83"><span class="id" title="variable">b</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Safety.html#V:88"><span class="id" title="variable">V</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#record_has"><span class="id" title="inductive">record_has</span></a> (<a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> (<a class="idref" href="Definitions.html#p_sel"><span class="id" title="constructor">p_sel</span></a> (<a class="idref" href="Definitions.html#avar_f"><span class="id" title="constructor">avar_f</span></a> <a class="idref" href="Safety.html#x:78"><span class="id" title="variable">x</span></a>) <a class="idref" href="Safety.html#bs':85"><span class="id" title="variable">bs'</span></a>) <a class="idref" href="Safety.html#U:87"><span class="id" title="variable">U</span></a>) <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">{</span></a><a class="idref" href="Safety.html#c:84"><span class="id" title="variable">c</span></a> <a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">⦂</span></a> <a class="idref" href="Safety.html#W:81"><span class="id" title="variable">W</span></a><a class="idref" href="Definitions.html#18cbe8108c7275adbcbe2d488cc0d64e"><span class="id" title="notation">}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hp</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">Hp</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simpl_dot</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hi</span> <span class="id" title="constructor">JMeq_refl</span> <span class="id" title="constructor">eq_refl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [-&gt; | [<span class="id" title="var">b</span> [<span class="id" title="var">c</span> [<span class="id" title="var">bs'</span> [<span class="id" title="var">bs''</span> [<span class="id" title="var">S</span> [<span class="id" title="var">V</span> [-&gt; [<span class="id" title="var">Hl</span> [<span class="id" title="var">Hl2</span> [<span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span>]]]]]]]]]]].<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "pf_bind"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="PreciseFlow.html#pf_binds"><span class="id" title="lemma">pf_binds</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hp</span>) <span class="id" title="keyword">as</span> -&gt;%<span class="id" title="lemma">binds_push_eq_inv</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_l</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Binding.html#open_var_typ_eq"><span class="id" title="lemma">open_var_typ_eq</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="PreciseFlow.html#pf_record_has_T"><span class="id" title="lemma">pf_record_has_T</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="PreciseFlow.html#pf_record_has_T"><span class="id" title="lemma">pf_record_has_T</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "pf_fld"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="PreciseFlow.html#pf_bnd_T2"><span class="id" title="lemma">pf_bnd_T2</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hp</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">W</span> -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">∃</span> (<span class="id" title="var">a</span> <span class="id" title="notation">::</span> <span class="id" title="var">bs''</span>). <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hl</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="PreciseFlow.html#pf_record_has_T"><span class="id" title="lemma">pf_record_has_T</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Every value of type <span class="inlinecode"><span class="id" title="var">T</span></span> has a precise type that is inert, well-formed,
    and is a subtype of <span class="inlinecode"><span class="id" title="var">T</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="val_typing" class="idref" href="#val_typing"><span class="id" title="lemma">val_typing</span></a> <a id="G:89" class="idref" href="#G:89"><span class="id" title="binder">G</span></a> <a id="x:90" class="idref" href="#x:90"><span class="id" title="binder">x</span></a> <a id="v:91" class="idref" href="#v:91"><span class="id" title="binder">v</span></a> <a id="T:92" class="idref" href="#T:92"><span class="id" title="binder">T</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:89"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:89"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#G:89"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Safety.html#v:91"><span class="id" title="variable">v</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:92"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#x:90"><span class="id" title="variable">x</span></a> <span class="id" title="notation">#</span> <a class="idref" href="Safety.html#G:89"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="T':93" class="idref" href="#T':93"><span class="id" title="binder">T'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#G:89"><span class="id" title="variable">G</span></a> <a class="idref" href="PreciseFlow.html#9352b36e773c80f96d88a9284b3018d7"><span class="id" title="notation">⊢!</span></a><a class="idref" href="PreciseFlow.html#9352b36e773c80f96d88a9284b3018d7"><span class="id" title="notation">v</span></a> <a class="idref" href="Safety.html#v:91"><span class="id" title="variable">v</span></a> <a class="idref" href="PreciseFlow.html#9352b36e773c80f96d88a9284b3018d7"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T':93"><span class="id" title="variable">T'</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:89"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#T':93"><span class="id" title="variable">T'</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">&lt;:</span></a> <a class="idref" href="Safety.html#T:92"><span class="id" title="variable">T</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> <a class="idref" href="Safety.html#T':93"><span class="id" title="variable">T'</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> (<a class="idref" href="Safety.html#G:89"><span class="id" title="variable">G</span></a> <span class="id" title="notation">&amp;</span> <a class="idref" href="Safety.html#x:90"><span class="id" title="variable">x</span></a> <span class="id" title="notation">~</span> <a class="idref" href="Safety.html#T':93"><span class="id" title="variable">T'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hv</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">Hv</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">∃</span> (<a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">∀(</span></a><span class="id" title="var">T</span><a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">)</span></a> <span class="id" title="var">U</span>). <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>×. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">introv</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">binds</span> <span class="id" title="var">x</span> (<a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">∀(</span></a><span class="id" title="var">T</span><a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">)</span></a> <span class="id" title="var">U</span>) (<span class="id" title="var">G</span> <span class="id" title="notation">&amp;</span> <span class="id" title="var">x</span> <span class="id" title="notation">~</span> <a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">∀(</span></a><span class="id" title="var">T</span><a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">)</span></a> <span class="id" title="var">U</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hb</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PreciseFlow.html#pf_bind"><span class="id" title="constructor">pf_bind</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">bs</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">bs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PreciseFlow.html#pf_binds"><span class="id" title="lemma">pf_binds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">binds_push_eq_inv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span> <span class="id" title="keyword">as</span> [=].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PreciseFlow.html#pf_sngl"><span class="id" title="lemma">pf_sngl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span> <span class="id" title="keyword">as</span> [? [? [=]%<a class="idref" href="PreciseFlow.html#pf_binds"><span class="id" title="lemma">pf_binds</span></a>%<span class="id" title="lemma">binds_push_eq_inv</span>]]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">∃</span> (<a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <span class="id" title="var">T</span>). <span class="id" title="tactic">assert</span> (<a class="idref" href="Definitions.html#inert_typ"><span class="id" title="inductive">inert_typ</span></a> (<a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <span class="id" title="var">T</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hin</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hv</span>: (<a class="idref" href="PreciseFlow.html#ty_new_intro_p"><span class="id" title="constructor">ty_new_intro_p</span></a> <span class="id" title="var">T</span> <span class="id" title="var">ds</span> <span class="id" title="var">H</span> <span class="id" title="var">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="PreciseFlow.html#pfv_inert"><span class="id" title="lemma">pfv_inert</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>×. <span class="id" title="var">pick_fresh</span> <span class="id" title="var">z</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">z</span> <span class="id" title="notation">\</span><span class="id" title="notation">notin</span> <span class="id" title="var">L</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hz</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">z</span> <span class="id" title="var">Hz</span>). <span class="id" title="tactic">assert</span> (<span class="id" title="var">z</span> <span class="id" title="notation">#</span> <span class="id" title="var">G</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hz'</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>×. <span class="id" title="var">introv</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="notation">∃</span> <a id="W:95" class="idref" href="#W:95"><span class="id" title="binder">W</span></a><span class="id" title="notation">,</span> <span class="id" title="var">G</span> <span class="id" title="notation">&amp;</span> <span class="id" title="var">x</span> <span class="id" title="notation">~</span> <span class="id" title="notation">(</span><a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <span class="id" title="var">T</span><span class="id" title="notation">)</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <span class="id" title="var">q</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#W:94"><span class="id" title="variable">W</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">W</span> <span class="id" title="var">Hq</span>]. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> (<span class="id" title="var">G</span> <span class="id" title="notation">&amp;</span> <span class="id" title="var">x</span> <span class="id" title="notation">~</span> <a class="idref" href="Definitions.html#57e8a3f1aebb1c6069654ec2f0cd7a19"><span class="id" title="notation">μ</span></a> <span class="id" title="var">T</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hi'</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#pf_sngl_to_lft"><span class="id" title="lemma">pf_sngl_to_lft</span></a> <span class="id" title="var">Hi'</span> <span class="id" title="var">Hp</span>) <span class="id" title="keyword">as</span> [-&gt; | [<span class="id" title="var">b</span> [<span class="id" title="var">c</span> [<span class="id" title="var">bs'</span> [<span class="id" title="var">bs''</span> [<span class="id" title="var">U</span> [<span class="id" title="var">V</span> [-&gt; [<span class="id" title="var">Hl1</span> [<span class="id" title="var">Hl2</span> [<span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span>]]]]]]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="PreciseFlow.html#pf_binds"><span class="id" title="lemma">pf_binds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span> <span class="id" title="keyword">as</span> [=]%<span class="id" title="lemma">binds_push_eq_inv</span>; <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">x</span><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <span class="id" title="constructor">nil</span><a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">;</span></a> <span class="id" title="var">G</span> <span class="id" title="notation">&amp;</span> <span class="id" title="var">x</span> <span class="id" title="notation">~</span> <a class="idref" href="Definitions.html#open_typ"><span class="id" title="definition">open_typ</span></a> <span class="id" title="var">x</span> <span class="id" title="var">T</span> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#open_defs"><span class="id" title="definition">open_defs</span></a> <span class="id" title="var">x</span> <span class="id" title="var">ds</span> <a class="idref" href="Definitions.html#ed2865d5b6635aaa6d875cc0fd7c034b"><span class="id" title="notation">::</span></a> <a class="idref" href="Definitions.html#open_typ"><span class="id" title="definition">open_typ</span></a> <span class="id" title="var">x</span> <span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Hdx</span>%<a class="idref" href="Binding.html#open_env_last_defs"><span class="id" title="lemma">open_env_last_defs</span></a>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Substitution.html#rename_defs"><span class="id" title="lemma">rename_defs</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span>:=<span class="id" title="var">z</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">bs''</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">bs'h</span> <span class="id" title="var">bs't</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">app_nil_l</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">inversions</span> <span class="id" title="var">Hl1</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">Hl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#defs_typing_sngl_rhs"><span class="id" title="lemma">defs_typing_sngl_rhs</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hdx</span>. <span class="id" title="tactic">rewrite</span>× <a class="idref" href="Binding.html#open_var_typ_eq"><span class="id" title="lemma">open_var_typ_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">app_comm_cons</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl1</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">Hl1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#defs_typing_rhs"><span class="id" title="lemma">defs_typing_rhs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hdx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Binding.html#open_var_typ_eq"><span class="id" title="lemma">open_var_typ_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hr2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hq</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">Hq'</span>%<a class="idref" href="PreciseTyping.html#pt2_exists"><span class="id" title="lemma">pt2_exists</span></a>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHv</span> <span class="id" title="var">_</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="constructor">eq_refl</span> <span class="id" title="var">Hx</span>). <span class="id" title="var">destruct_all</span>. <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span>×.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Helper tactics for proving Preservation 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">lookup_eq</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hl1</span>: ?<span class="id" title="var">s</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟦</span></a> <span class="id" title="var">_</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⤳*</span></a> <a class="idref" href="Definitions.html#defv"><span class="id" title="constructor">defv</span></a> ?<span class="id" title="var">t1</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟧</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hl2</span>: ?<span class="id" title="var">s</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟦</span></a> <span class="id" title="var">_</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⤳*</span></a> <a class="idref" href="Definitions.html#defv"><span class="id" title="constructor">defv</span></a> ?<span class="id" title="var">t2</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟧</span></a> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="Lookup.html#lookup_func"><span class="id" title="lemma">lookup_func</span></a> <span class="id" title="var">Hl1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hl2</span>; <span class="id" title="var">inversions</span> <span class="id" title="var">Hl2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">invert_red</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hr</span>: <span class="id" title="notation">(</span><span class="id" title="var">_</span><span class="id" title="notation">,</span> <span class="id" title="var">_</span><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#6a0a2cd1c1d834551a7de9c07376fb83"><span class="id" title="notation">⟼</span></a> <span class="id" title="notation">(</span><span class="id" title="var">_</span><span class="id" title="notation">,</span> <span class="id" title="var">_</span><span class="id" title="notation">)</span> |- <span class="id" title="var">_</span>] ⇒ <span class="id" title="var">inversions</span> <span class="id" title="var">Hr</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_IH</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">IH</span>: <span class="id" title="var">_</span> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <span class="id" title="var">_</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <span class="id" title="var">_</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <span class="id" title="var">_</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="t':97" class="idref" href="#t':97"><span class="id" title="binder">t'</span></a>, <span class="id" title="notation">(</span><span class="id" title="var">_</span><span class="id" title="notation">,</span> <span class="id" title="var">_</span><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#6a0a2cd1c1d834551a7de9c07376fb83"><span class="id" title="notation">⟼</span></a> <span class="id" title="notation">(</span><span class="id" title="var">_</span><span class="id" title="notation">,</span> <span class="id" title="var">_</span><span class="id" title="notation">)</span> <span class="id" title="notation">→</span> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Wt</span>: <span class="id" title="var">_</span> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span>: <a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Wf</span>: <a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hr</span>: <span class="id" title="notation">(</span><span class="id" title="var">_</span><span class="id" title="notation">,</span> <span class="id" title="var">_</span><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#6a0a2cd1c1d834551a7de9c07376fb83"><span class="id" title="notation">⟼</span></a> <span class="id" title="notation">(</span><span class="id" title="var">_</span><span class="id" title="notation">,</span> ?<span class="id" title="var">t'</span><span class="id" title="notation">)</span> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IH</span> <span class="id" title="var">Wt</span> <span class="id" title="var">In</span> <span class="id" title="var">Wf</span> <span class="id" title="var">t'</span> <span class="id" title="var">Hr</span>); <span class="id" title="var">destruct_all</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">Hi</span>: <span class="id" title="var">_</span> <span class="id" title="notation">&amp;</span> ?<span class="id" title="var">G'</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <span class="id" title="var">_</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">G'</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_let</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">invert_red</span>; <span class="id" title="var">solve_IH</span>; <span class="id" title="var">fresh_constructor</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">apply</span>× <a class="idref" href="Weakening.html#weaken_rules"><span class="id" title="lemma">weaken_rules</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="matched_case_typing" class="idref" href="#matched_case_typing"><span class="id" title="lemma">matched_case_typing</span></a>: <span class="id" title="keyword">∀</span> <a id="c14265cc2bfcd8025ac31ec9d6ed7848" class="idref" href="#c14265cc2bfcd8025ac31ec9d6ed7848"><span class="id" title="binder">γ</span></a> <a id="G:99" class="idref" href="#G:99"><span class="id" title="binder">G</span></a> <a id="p:100" class="idref" href="#p:100"><span class="id" title="binder">p</span></a> <a id="q:101" class="idref" href="#q:101"><span class="id" title="binder">q</span></a> <a id="r:102" class="idref" href="#r:102"><span class="id" title="binder">r</span></a> <a id="A:103" class="idref" href="#A:103"><span class="id" title="binder">A</span></a> <a id="T0:104" class="idref" href="#T0:104"><span class="id" title="binder">T0</span></a> <a id="T:105" class="idref" href="#T:105"><span class="id" title="binder">T</span></a> <a id="ds:106" class="idref" href="#ds:106"><span class="id" title="binder">ds</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:99"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:99"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#c14265cc2bfcd8025ac31ec9d6ed7848"><span class="id" title="variable">γ</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:99"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:99"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#p:100"><span class="id" title="variable">p</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:105"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#c14265cc2bfcd8025ac31ec9d6ed7848"><span class="id" title="variable">γ</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⟦</span></a> <a class="idref" href="Safety.html#p:100"><span class="id" title="variable">p</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⤳</span></a> <a class="idref" href="Definitions.html#defv"><span class="id" title="constructor">defv</span></a> (<a class="idref" href="Definitions.html#fb8fa075fb63e32f0a950a9184c4daef"><span class="id" title="notation">ν</span></a> <a class="idref" href="Definitions.html#fb8fa075fb63e32f0a950a9184c4daef"><span class="id" title="notation">[</span></a><a class="idref" href="Safety.html#q:101"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#fb8fa075fb63e32f0a950a9184c4daef"><span class="id" title="notation">↘</span></a> <a class="idref" href="Safety.html#A:103"><span class="id" title="variable">A</span></a><a class="idref" href="Definitions.html#fb8fa075fb63e32f0a950a9184c4daef"><span class="id" title="notation">](</span></a><a class="idref" href="Safety.html#T0:104"><span class="id" title="variable">T0</span></a><a class="idref" href="Definitions.html#fb8fa075fb63e32f0a950a9184c4daef"><span class="id" title="notation">)</span></a> <a class="idref" href="Safety.html#ds:106"><span class="id" title="variable">ds</span></a>) <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⟧</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#c14265cc2bfcd8025ac31ec9d6ed7848"><span class="id" title="variable">γ</span></a> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟦</span></a> <a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> (<a class="idref" href="Definitions.html#open_path_p"><span class="id" title="definition">open_path_p</span></a> <a class="idref" href="Safety.html#p:100"><span class="id" title="variable">p</span></a> <a class="idref" href="Safety.html#q:101"><span class="id" title="variable">q</span></a>) <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⤳*</span></a> <a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> <a class="idref" href="Safety.html#r:102"><span class="id" title="variable">r</span></a> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟧</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:99"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#p:100"><span class="id" title="variable">p</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#r:102"><span class="id" title="variable">r</span></a> <a class="idref" href="Definitions.html#56a240108deb0dfbaeb49e48db859cf7"><span class="id" title="notation">↓</span></a> <a class="idref" href="Safety.html#A:103"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hp</span> <span class="id" title="var">Hm1</span> <span class="id" title="var">Hm2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#star_one"><span class="id" title="lemma">star_one</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hcf</span>: (<a class="idref" href="CanonicalForms.html#canonical_forms_obj"><span class="id" title="lemma">canonical_forms_obj</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hm1</span> <span class="id" title="var">Hp</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hx</span>: (<a class="idref" href="CanonicalForms.html#path_sel_implies_typed_path"><span class="id" title="lemma">path_sel_implies_typed_path</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hcf</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hx</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U</span> <span class="id" title="var">Hxp</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hx</span>: <span class="id" title="var">G</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> (<a class="idref" href="Definitions.html#open_path_p"><span class="id" title="definition">open_path_p</span></a> <span class="id" title="var">p</span> <span class="id" title="var">q</span>) <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Definitions.html#typ_rcd"><span class="id" title="constructor">typ_rcd</span></a> <a class="idref" href="Definitions.html#b194d02349b51cad3901d2caba34fa00"><span class="id" title="notation">{</span></a><span class="id" title="var">A</span> <a class="idref" href="Definitions.html#b194d02349b51cad3901d2caba34fa00"><span class="id" title="notation">&gt;:</span></a> <span class="id" title="var">U</span> <a class="idref" href="Definitions.html#b194d02349b51cad3901d2caba34fa00"><span class="id" title="notation">&lt;:</span></a> <span class="id" title="var">U</span><a class="idref" href="Definitions.html#b194d02349b51cad3901d2caba34fa00"><span class="id" title="notation">}</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>× <a class="idref" href="PreciseTyping.html#precise_to_general3"><span class="id" title="lemma">precise_to_general3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrl</span>: <span class="id" title="var">γ</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟦</span></a> <a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> <span class="id" title="var">r</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⤳*</span></a> <a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> <span class="id" title="var">r</span> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟧</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#star_refl"><span class="id" title="constructor">star_refl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hrppp</span>: (<a class="idref" href="CanonicalForms.html#lookup_pres"><span class="id" title="lemma">lookup_pres</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hxp</span> <span class="id" title="var">Hm2</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hrppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U0</span> <span class="id" title="var">Hrppp</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hrt</span>: (<a class="idref" href="PreciseTyping.html#precise_to_general3"><span class="id" title="lemma">precise_to_general3</span></a> <span class="id" title="var">Hrppp</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hd</span>: (<a class="idref" href="CanonicalForms.html#path_lookup_implies_sngl_typing"><span class="id" title="lemma">path_lookup_implies_sngl_typing</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hx</span> <span class="id" title="var">Hrt</span> <span class="id" title="var">Hm2</span> <span class="id" title="var">Hrl</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_sub"><span class="id" title="constructor">ty_sub</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">T</span>:=<a class="idref" href="Definitions.html#open_path_p"><span class="id" title="definition">open_path_p</span></a> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <a class="idref" href="Definitions.html#56a240108deb0dfbaeb49e48db859cf7"><span class="id" title="notation">↓</span></a> <span class="id" title="var">A</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#subtyp_sngl_pq"><span class="id" title="constructor">subtyp_sngl_pq</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span>:=(<a class="idref" href="Definitions.html#open_path_p"><span class="id" title="definition">open_path_p</span></a> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)) (<span class="id" title="var">q</span>:=<span class="id" title="var">r</span>) (<span class="id" title="var">U</span>:=<span class="id" title="var">U0</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Replacement.html#repl_intro_path_sel"><span class="id" title="lemma">repl_intro_path_sel</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subtyp_and_extend_r" class="idref" href="#subtyp_and_extend_r"><span class="id" title="lemma">subtyp_and_extend_r</span></a> : <span class="id" title="keyword">∀</span> <a id="G:107" class="idref" href="#G:107"><span class="id" title="binder">G</span></a> <a id="S:108" class="idref" href="#S:108"><span class="id" title="binder">S</span></a> <a id="T:109" class="idref" href="#T:109"><span class="id" title="binder">T</span></a> <a id="U:110" class="idref" href="#U:110"><span class="id" title="binder">U</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:107"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#S:108"><span class="id" title="variable">S</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">&lt;:</span></a> <a class="idref" href="Safety.html#T:109"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:107"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#S:108"><span class="id" title="variable">S</span></a> <a class="idref" href="Definitions.html#7a630e21245026e1b75685a10a5ca45a"><span class="id" title="notation">∧</span></a> <a class="idref" href="Safety.html#U:110"><span class="id" title="variable">U</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">&lt;:</span></a> <a class="idref" href="Safety.html#T:109"><span class="id" title="variable">T</span></a> <a class="idref" href="Definitions.html#7a630e21245026e1b75685a10a5ca45a"><span class="id" title="notation">∧</span></a> <a class="idref" href="Safety.html#U:110"><span class="id" title="variable">U</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">Hsub</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#subtyp_and2"><span class="id" title="constructor">subtyp_and2</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="Definitions.html#subtyp_trans"><span class="id" title="constructor">subtyp_trans</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#subtyp_and11"><span class="id" title="constructor">subtyp_and11</span></a>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#subtyp_and12"><span class="id" title="constructor">subtyp_and12</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subtyp_and_extend_l" class="idref" href="#subtyp_and_extend_l"><span class="id" title="lemma">subtyp_and_extend_l</span></a> : <span class="id" title="keyword">∀</span> <a id="G:111" class="idref" href="#G:111"><span class="id" title="binder">G</span></a> <a id="S:112" class="idref" href="#S:112"><span class="id" title="binder">S</span></a> <a id="T:113" class="idref" href="#T:113"><span class="id" title="binder">T</span></a> <a id="U:114" class="idref" href="#U:114"><span class="id" title="binder">U</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:111"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#T:113"><span class="id" title="variable">T</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">&lt;:</span></a> <a class="idref" href="Safety.html#U:114"><span class="id" title="variable">U</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:111"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#S:112"><span class="id" title="variable">S</span></a> <a class="idref" href="Definitions.html#7a630e21245026e1b75685a10a5ca45a"><span class="id" title="notation">∧</span></a> <a class="idref" href="Safety.html#T:113"><span class="id" title="variable">T</span></a> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">&lt;:</span></a> <a class="idref" href="Safety.html#S:112"><span class="id" title="variable">S</span></a> <a class="idref" href="Definitions.html#7a630e21245026e1b75685a10a5ca45a"><span class="id" title="notation">∧</span></a> <a class="idref" href="Safety.html#U:114"><span class="id" title="variable">U</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">Hsub</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#subtyp_and2"><span class="id" title="constructor">subtyp_and2</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#subtyp_and11"><span class="id" title="constructor">subtyp_and11</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="Definitions.html#subtyp_trans"><span class="id" title="constructor">subtyp_trans</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#subtyp_and12"><span class="id" title="constructor">subtyp_and12</span></a>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ty_lookup_trans" class="idref" href="#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="G:115" class="idref" href="#G:115"><span class="id" title="binder">G</span></a> <a id="4d84575ea5a88a5287a97fbbaca05ee0" class="idref" href="#4d84575ea5a88a5287a97fbbaca05ee0"><span class="id" title="binder">γ</span></a> <a id="p:117" class="idref" href="#p:117"><span class="id" title="binder">p</span></a> <a id="q:118" class="idref" href="#q:118"><span class="id" title="binder">q</span></a> <a id="T:119" class="idref" href="#T:119"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:115"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:115"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#4d84575ea5a88a5287a97fbbaca05ee0"><span class="id" title="variable">γ</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:115"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#4d84575ea5a88a5287a97fbbaca05ee0"><span class="id" title="variable">γ</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⟦</span></a> <a class="idref" href="Safety.html#p:117"><span class="id" title="variable">p</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⤳</span></a> <a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> <a class="idref" href="Safety.html#q:118"><span class="id" title="variable">q</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⟧</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:115"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#p:117"><span class="id" title="variable">p</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:119"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:115"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#q:118"><span class="id" title="variable">q</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:119"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hl</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hpp</span>: (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hp</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U</span> <span class="id" title="var">Hpp</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hps</span>: (<a class="idref" href="CanonicalForms.html#lookup_step_sngl"><span class="id" title="lemma">lookup_step_sngl</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hpp</span> <span class="id" title="var">Hl</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hqp</span>: (<a class="idref" href="CanonicalForms.html#lookup_step_pres"><span class="id" title="lemma">lookup_step_pres</span></a> <span class="id" title="var">Hin</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hpp</span> <span class="id" title="var">Hl</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hqp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U'</span> <span class="id" title="var">Hqp</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PreciseTyping.html#precise_to_general3"><span class="id" title="lemma">precise_to_general3</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hqp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_sngl"><span class="id" title="constructor">ty_sngl</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">q</span> := <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_sub"><span class="id" title="constructor">ty_sub</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">T</span> := <a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">{{</span></a><span class="id" title="var">q</span><a class="idref" href="Definitions.html#2e12ae37c5a5c7396a13d7170e0de451"><span class="id" title="notation">}}</span></a>). <span class="id" title="tactic">apply</span>× <a class="idref" href="Definitions.html#ty_self"><span class="id" title="constructor">ty_self</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Definitions.html#subtyp_sngl_qp"><span class="id" title="constructor">subtyp_sngl_qp</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hps</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hqp</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Replacement.html#repl_intro_sngl"><span class="id" title="lemma">repl_intro_sngl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab95"></a><h4 class="section">Preservation (Theorem 4.2)</h4>
 If a term <span class="inlinecode"><span class="id" title="var">γ</span>|<span class="id" title="var">t</span></span> has type <span class="inlinecode"><span class="id" title="var">T</span></span> and reduces to <span class="inlinecode"><span class="id" title="var">γ'</span>|<span class="id" title="var">t'</span></span> then the latter has
    the same type <span class="inlinecode"><span class="id" title="var">T</span></span> under an extended environment that is inert, well-typed,
    and well-formed. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="preservation" class="idref" href="#preservation"><span class="id" title="lemma">preservation</span></a>: <span class="id" title="keyword">∀</span> <a id="G:120" class="idref" href="#G:120"><span class="id" title="binder">G</span></a> <a id="2312620cb31c2c632234bb903aad4369" class="idref" href="#2312620cb31c2c632234bb903aad4369"><span class="id" title="binder">γ</span></a> <a id="t:122" class="idref" href="#t:122"><span class="id" title="binder">t</span></a> <a id="922c9af34d4a504dc50419573510530c" class="idref" href="#922c9af34d4a504dc50419573510530c"><span class="id" title="binder">γ'</span></a> <a id="t':124" class="idref" href="#t':124"><span class="id" title="binder">t'</span></a> <a id="T:125" class="idref" href="#T:125"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#2312620cb31c2c632234bb903aad4369"><span class="id" title="variable">γ</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:120"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:120"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:120"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#2312620cb31c2c632234bb903aad4369"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:122"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#6a0a2cd1c1d834551a7de9c07376fb83"><span class="id" title="notation">⟼</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#922c9af34d4a504dc50419573510530c"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':124"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:120"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t:122"><span class="id" title="variable">t</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:125"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="G':126" class="idref" href="#G':126"><span class="id" title="binder">G'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G':126"><span class="id" title="variable">G'</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> (<a class="idref" href="Safety.html#G:120"><span class="id" title="variable">G</span></a> <span class="id" title="notation">&amp;</span> <a class="idref" href="Safety.html#G':126"><span class="id" title="variable">G'</span></a>) <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#922c9af34d4a504dc50419573510530c"><span class="id" title="variable">γ'</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:120"><span class="id" title="variable">G</span></a> <span class="id" title="notation">&amp;</span> <a class="idref" href="Safety.html#G':126"><span class="id" title="variable">G'</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:120"><span class="id" title="variable">G</span></a> <span class="id" title="notation">&amp;</span> <a class="idref" href="Safety.html#G':126"><span class="id" title="variable">G'</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t':124"><span class="id" title="variable">t'</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:125"><span class="id" title="variable">T</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hred</span> <span class="id" title="var">Ht</span>. <span class="id" title="var">gen</span> <span class="id" title="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">invert_red</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>. <span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "ty_all_elim"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">Hp</span>: <span class="id" title="var">_</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <span class="id" title="var">_</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">∀(</span></a><span class="id" title="var">_</span><a class="idref" href="Definitions.html#5602fefe5ae9ac7607d0a75368b09df0"><span class="id" title="notation">)</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="CanonicalForms.html#canonical_forms_fun"><span class="id" title="lemma">canonical_forms_fun</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hp</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">L</span> [<span class="id" title="var">T'</span> [<span class="id" title="var">t</span> [<span class="id" title="var">Hl</span> [<span class="id" title="var">Hsub</span> <span class="id" title="var">Hty</span>]]]]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_red</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#star_one"><span class="id" title="lemma">star_one</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">lookup_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pick_fresh</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">y</span> <span class="id" title="notation">\</span><span class="id" title="notation">notin</span> <span class="id" title="var">L</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">FrL</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hty</span> <span class="id" title="var">y</span> <span class="id" title="var">FrL</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Substitution.html#subst_var_path"><span class="id" title="lemma">subst_var_path</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;reducing&nbsp;p&nbsp;in&nbsp;p&nbsp;q&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt1</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">_</span> <span class="id" title="var">H0</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHt1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">G'</span> [<span class="id" title="var">Hi'</span> [<span class="id" title="var">Hwf'</span> [<span class="id" title="var">Hwt'</span> <span class="id" title="var">Ht'</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">G'</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_all_elim"><span class="id" title="constructor">ty_all_elim</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">S</span>:=<span class="id" title="var">S</span>). <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="Weakening.html#weaken_ty_trm"><span class="id" title="lemma">weaken_ty_trm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;reducing&nbsp;q&nbsp;in&nbsp;p&nbsp;q&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt2</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">_</span> <span class="id" title="var">H5</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHt2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">G'</span> [<span class="id" title="var">Hi'</span> [<span class="id" title="var">Hwf'</span> [<span class="id" title="var">Hwt'</span> <span class="id" title="var">Ht'</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">G'</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hqp</span>: (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Ht2</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hqp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U</span> <span class="id" title="var">Hqp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hqs</span>: (<a class="idref" href="CanonicalForms.html#lookup_step_sngl"><span class="id" title="lemma">lookup_step_sngl</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hqp</span> <span class="id" title="var">H0</span>). <span class="id" title="tactic">apply</span>× <a class="idref" href="Weakening.html#weaken_ty_trm"><span class="id" title="lemma">weaken_ty_trm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hp'</span>: (<a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">H0</span> <span class="id" title="var">Ht2</span>). <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_sub"><span class="id" title="constructor">ty_sub</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">T</span> := <a class="idref" href="Definitions.html#open_typ_p"><span class="id" title="definition">open_typ_p</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">T</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_all_elim"><span class="id" title="constructor">ty_all_elim</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">S</span> := <span class="id" title="var">S</span>). <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="CanonicalForms.html#subtyp_sngl_qp_repeat"><span class="id" title="lemma">subtyp_sngl_qp_repeat</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hqs</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hp'</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Replacement.html#repl_comp_open"><span class="id" title="lemma">repl_comp_open</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>. <span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>. <span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "ty_let"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">solve_let</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">SCase</span> "[t = (let x = v in u)] where v is a value"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">Hn</span>: ?<span class="id" title="var">x</span> <span class="id" title="notation">#</span> ?<span class="id" title="var">s</span> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Binding.html#well_typed_notin_dom"><span class="id" title="lemma">well_typed_notin_dom</span></a> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hn</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hng</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#val_typing"><span class="id" title="lemma">val_typing</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Ht</span> <span class="id" title="var">Hng</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">V</span> [<span class="id" title="var">Hv</span> [<span class="id" title="var">Hs</span> [<span class="id" title="var">Hin</span> <span class="id" title="var">Hwf'</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<span class="id" title="var">x</span> <span class="id" title="notation">~</span> <span class="id" title="var">V</span>). <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">concat_empty_l</span>. <span class="id" title="tactic">constructor</span>~.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">constructor</span>~. <span class="id" title="tactic">apply</span> (<a class="idref" href="PreciseFlow.html#precise_to_general_v"><span class="id" title="lemma">precise_to_general_v</span></a> <span class="id" title="var">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> <a class="idref" href="Binding.html#open_var_trm_eq"><span class="id" title="lemma">open_var_trm_eq</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Substitution.html#subst_fresh_var_path"><span class="id" title="lemma">subst_fresh_var_path</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">L</span>:=<span class="id" title="var">L</span> <span class="id" title="notation">\</span><span class="id" title="notation">u</span> <span class="id" title="axiom">dom</span> <span class="id" title="var">G</span> <span class="id" title="notation">\</span><span class="id" title="notation">u</span> <span class="id" title="notation">\{</span><span class="id" title="var">x</span><span class="id" title="notation">}</span>). <span class="id" title="tactic">apply</span>× <span class="id" title="constructor">ok_push</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Weakening.html#weaken_rules"><span class="id" title="lemma">weaken_rules</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_sub"><span class="id" title="constructor">ty_sub</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">T</span>:=<span class="id" title="var">V</span>); <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Weakening.html#weaken_subtyp"><span class="id" title="lemma">weaken_subtyp</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">SCase</span> "[t = (let x = p in u)] where a is p variable"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="Substitution.html#subst_fresh_var_path"><span class="id" title="lemma">subst_fresh_var_path</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fresh_constructor</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "ty_case"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hred</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;matched&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hcf</span>: (<a class="idref" href="Safety.html#matched_case_typing"><span class="id" title="lemma">matched_case_typing</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Ht1</span> <span class="id" title="var">H10</span> <span class="id" title="var">H11</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Substitution.html#subst_fresh_var_path"><span class="id" title="lemma">subst_fresh_var_path</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_and_intro"><span class="id" title="constructor">ty_and_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="Definitions.html#ty_self"><span class="id" title="constructor">ty_self</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hcf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">Hcf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;unmatched:&nbsp;tag&nbsp;mismatch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;unmatched:&nbsp;func&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;reducing&nbsp;scrutinee&nbsp;path&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fresh_constructor</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Ht2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Narrowing.html#narrow_typing"><span class="id" title="lemma">narrow_typing</span></a>. <span class="id" title="tactic">apply</span>~ <a class="idref" href="Subenvironments.html#subenv_last"><span class="id" title="lemma">subenv_last</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Safety.html#subtyp_and_extend_r"><span class="id" title="lemma">subtyp_and_extend_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hpppp</span>: (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Ht1</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U0</span> <span class="id" title="var">Hpppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hlpp'</span>: (<a class="idref" href="CanonicalForms.html#lookup_step_sngl"><span class="id" title="lemma">lookup_step_sngl</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hpppp</span> <span class="id" title="var">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hp'</span>: (<a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">H3</span> <span class="id" title="var">Ht1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Definitions.html#subtyp_sngl_qp"><span class="id" title="constructor">subtyp_sngl_qp</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hlpp'</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hp'</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Replacement.html#repl_intro_sngl"><span class="id" title="lemma">repl_intro_sngl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;reducing&nbsp;pattern&nbsp;path&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fresh_constructor</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Ht1</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Narrowing.html#narrow_typing"><span class="id" title="lemma">narrow_typing</span></a>. <span class="id" title="tactic">apply</span>~ <a class="idref" href="Subenvironments.html#subenv_last"><span class="id" title="lemma">subenv_last</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Safety.html#subtyp_and_extend_l"><span class="id" title="lemma">subtyp_and_extend_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hqppp</span>: (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Ht2</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hqppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U0</span> <span class="id" title="var">Hqppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hlpp'</span>: (<a class="idref" href="CanonicalForms.html#lookup_step_sngl"><span class="id" title="lemma">lookup_step_sngl</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hqppp</span> <span class="id" title="var">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hr'</span>: (<a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">H2</span> <span class="id" title="var">Ht2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Definitions.html#subtyp_sngl_qp"><span class="id" title="constructor">subtyp_sngl_qp</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hlpp'</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hr'</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Replacement.html#repl_intro_path_sel"><span class="id" title="lemma">repl_intro_path_sel</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Definitions.html#ty_sngl"><span class="id" title="constructor">ty_sngl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Definitions.html#ty_self"><span class="id" title="constructor">ty_self</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Definitions.html#ty_path_elim"><span class="id" title="constructor">ty_path_elim</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Definitions.html#ty_rec_intro"><span class="id" title="constructor">ty_rec_intro</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (@<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#typ"><span class="id" title="inductive">typ</span></a>). <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">concat_empty_r</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>~ <a class="idref" href="Safety.html#ty_lookup_trans"><span class="id" title="lemma">ty_lookup_trans</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">constructor</span>×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "ty_sub"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">Hs</span>: <span class="id" title="var">_</span> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">⊢</span></a> <span class="id" title="var">_</span> <a class="idref" href="Definitions.html#d77433d9a5f06bee50380b6ca9a3f271"><span class="id" title="notation">&lt;:</span></a> <span class="id" title="var">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hg</span>: <span class="id" title="var">_</span> <span class="id" title="notation">&amp;</span> ?<span class="id" title="var">G'</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <span class="id" title="var">_</span><a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Weakening.html#weaken_subtyp"><span class="id" title="lemma">weaken_subtyp</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">G2</span>:=<span class="id" title="var">G'</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab96"></a><h4 class="section">Progress (Theorem 4.3)</h4>
 Any well-typed term is either in normal form (i.e. a path or value) or can
    take a reduction step. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="progress" class="idref" href="#progress"><span class="id" title="lemma">progress</span></a>: <span class="id" title="keyword">∀</span> <a id="G:127" class="idref" href="#G:127"><span class="id" title="binder">G</span></a> <a id="04c4f765dc3dcb4ab1fdb3839ee0cb89" class="idref" href="#04c4f765dc3dcb4ab1fdb3839ee0cb89"><span class="id" title="binder">γ</span></a> <a id="t:129" class="idref" href="#t:129"><span class="id" title="binder">t</span></a> <a id="T:130" class="idref" href="#T:130"><span class="id" title="binder">T</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:127"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:127"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#04c4f765dc3dcb4ab1fdb3839ee0cb89"><span class="id" title="variable">γ</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:127"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:127"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t:129"><span class="id" title="variable">t</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:130"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Reduction.html#norm_form"><span class="id" title="inductive">norm_form</span></a> <a class="idref" href="Safety.html#04c4f765dc3dcb4ab1fdb3839ee0cb89"><span class="id" title="variable">γ</span></a> <a class="idref" href="Safety.html#t:129"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∨</span> <span class="id" title="notation">∃</span> <a id="49e099e96ce9617e6898a3dcfd42b891" class="idref" href="#49e099e96ce9617e6898a3dcfd42b891"><span class="id" title="binder">γ'</span></a> <a id="t':132" class="idref" href="#t':132"><span class="id" title="binder">t'</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#04c4f765dc3dcb4ab1fdb3839ee0cb89"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:129"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#6a0a2cd1c1d834551a7de9c07376fb83"><span class="id" title="notation">⟼</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#49e099e96ce9617e6898a3dcfd42b891"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':132"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_var"><span class="id" title="constructor">ty_var</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U</span> <span class="id" title="var">Hppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CanonicalForms.html#typ_to_lookup3"><span class="id" title="lemma">typ_to_lookup3</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hppp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt1</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">inversions</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="CanonicalForms.html#canonical_forms_fun"><span class="id" title="lemma">canonical_forms_fun</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Ht1</span>). <span class="id" title="var">destruct_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>×. <span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#star_one"><span class="id" title="lemma">star_one</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hl</span>. <span class="id" title="var">lookup_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt2</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">IHHt2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Reduction.html#red_app"><span class="id" title="constructor">red_app</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H0</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">destruct_all</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Reduction.html#red_ctx_app2"><span class="id" title="constructor">red_ctx_app2</span></a>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Reduction.html#red_resolve"><span class="id" title="constructor">red_resolve</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>×. <span class="id" title="var">destruct_all</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Reduction.html#red_ctx_app1"><span class="id" title="constructor">red_ctx_app1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Reduction.html#red_resolve"><span class="id" title="constructor">red_resolve</span></a>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_new_elim"><span class="id" title="constructor">ty_new_elim</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hpppp</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U</span> <span class="id" title="var">Hpppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CanonicalForms.html#typ_to_lookup3"><span class="id" title="lemma">typ_to_lookup3</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Definitions.html#ty_rcd_intro"><span class="id" title="constructor">ty_rcd_intro</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hpppp</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U</span> <span class="id" title="var">Hpppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CanonicalForms.html#typ_to_lookup3"><span class="id" title="lemma">typ_to_lookup3</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "ty_let"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="var">pick_fresh</span> <span class="id" title="var">z</span>. <span class="id" title="tactic">∃</span> (<span class="id" title="var">γ</span> <span class="id" title="notation">&amp;</span> <span class="id" title="var">z</span> <span class="id" title="notation">~</span> <span class="id" title="var">v</span>). <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hn</span> | [<span class="id" title="var">γ'</span> [<span class="id" title="var">t'</span> <span class="id" title="var">Hr</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hn</span>. } <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hn</span> | [<span class="id" title="var">γ'</span> [<span class="id" title="var">t'</span> <span class="id" title="var">Hr</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hn</span>. } <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hn</span> | [<span class="id" title="var">γ'</span> [<span class="id" title="var">t'</span> <span class="id" title="var">Hr</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hn</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">destruct_all</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Reduction.html#red_let_path"><span class="id" title="constructor">red_let_path</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hn</span> | [<span class="id" title="var">γ'</span> [<span class="id" title="var">t'</span> <span class="id" title="var">Hr</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hn</span>. } <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">Case</span> "ty_case"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Ht1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hpppp</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U0</span> <span class="id" title="var">Hpppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CanonicalForms.html#typ_to_lookup3"><span class="id" title="lemma">typ_to_lookup3</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Reduction.html#red_ctx_case1"><span class="id" title="constructor">red_ctx_case1</span></a>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Ht2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hqppp</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hqppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U1</span> <span class="id" title="var">Hqppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CanonicalForms.html#typ_to_lookup3"><span class="id" title="lemma">typ_to_lookup3</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hqppp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hl2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hl2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t'</span> <span class="id" title="var">Hl2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Reduction.html#red_ctx_case2"><span class="id" title="constructor">red_ctx_case2</span></a>. <span class="id" title="tactic">∃</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="lemma">classicT</span> (<span class="id" title="var">t</span> <span class="id" title="notation">=</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#star_one"><span class="id" title="lemma">star_one</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hll</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hcf</span>: (<a class="idref" href="CanonicalForms.html#canonical_forms_obj"><span class="id" title="lemma">canonical_forms_obj</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hll</span> <span class="id" title="var">Ht1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hcfp0</span>: (<a class="idref" href="CanonicalForms.html#resolve_typeable_path_sel"><span class="id" title="lemma">resolve_typeable_path_sel</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hcf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcfp0</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> [<span class="id" title="var">r0</span> [<span class="id" title="var">Hp0r</span> <span class="id" title="var">Hrv</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="lemma">classicT</span> (<span class="id" title="var">r0</span> <span class="id" title="notation">=</span> <span class="id" title="var">q</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Reduction.html#red_case_match"><span class="id" title="constructor">red_case_match</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hrv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Hl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Hp0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Reduction.html#red_case_else"><span class="id" title="constructor">red_case_else</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">left</span>×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#star_one"><span class="id" title="lemma">star_one</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hll</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hcf</span>: (<a class="idref" href="CanonicalForms.html#canonical_forms_obj"><span class="id" title="lemma">canonical_forms_obj</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hll</span> <span class="id" title="var">Ht1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">Hcfp0</span>: (<a class="idref" href="CanonicalForms.html#resolve_typeable_path_sel"><span class="id" title="lemma">resolve_typeable_path_sel</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hcf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcfp0</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> [<span class="id" title="var">r0</span> [<span class="id" title="var">Hp0r</span> <span class="id" title="var">Hrv</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Reduction.html#red_case_else"><span class="id" title="constructor">red_case_else</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">right</span>×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Reduction.html#red_case_lambda"><span class="id" title="constructor">red_case_lambda</span></a>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;- <span class="id" title="var">lets</span> <span class="id" title="var">Ht</span>: (<a class="idref" href="Definitions.html#ty_path_elim"><span class="id" title="constructor">ty_path_elim</span></a> <span class="id" title="var">a</span> <span class="id" title="var">Ht1</span> <span class="id" title="var">Ht2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="GeneralToTight.html#pt3_exists"><span class="id" title="lemma">pt3_exists</span></a> <span class="id" title="var">Hi</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hpppp</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U0</span> <span class="id" title="var">Hpppp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CanonicalForms.html#typ_to_lookup3"><span class="id" title="lemma">typ_to_lookup3</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hpppp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>×.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab97"></a><h3 class="section">Safety</h3>

<div class="paragraph"> </div>

 If a term <span class="inlinecode"><span class="id" title="var">γ</span>|<span class="id" title="var">t</span></span> has type <span class="inlinecode"><span class="id" title="var">T</span></span> and reduces in a finite number of steps
    to <span class="inlinecode"><span class="id" title="var">γ'</span>|<span class="id" title="var">t'</span></span> then the latter is either in normal form and has type <span class="inlinecode"><span class="id" title="var">T</span></span>,
    or it can take a further step to a term <span class="inlinecode"><span class="id" title="var">γ''</span>|<span class="id" title="var">t''</span></span>, where <span class="inlinecode"><span class="id" title="var">t''</span></span> also
    has type <span class="inlinecode"><span class="id" title="var">T</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="safety_helper" class="idref" href="#safety_helper"><span class="id" title="lemma">safety_helper</span></a> <a id="G:133" class="idref" href="#G:133"><span class="id" title="binder">G</span></a> <a id="t1:134" class="idref" href="#t1:134"><span class="id" title="binder">t1</span></a> <a id="t2:135" class="idref" href="#t2:135"><span class="id" title="binder">t2</span></a> <a id="6852841dbb53ef4979d329bd0dda4698" class="idref" href="#6852841dbb53ef4979d329bd0dda4698"><span class="id" title="binder">γ1</span></a> <a id="e79e1c459cbcefc74bb95f284a781f87" class="idref" href="#e79e1c459cbcefc74bb95f284a781f87"><span class="id" title="binder">γ2</span></a> <a id="T:138" class="idref" href="#T:138"><span class="id" title="binder">T</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#G:133"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t1:134"><span class="id" title="variable">t1</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:138"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:133"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:133"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#6852841dbb53ef4979d329bd0dda4698"><span class="id" title="variable">γ1</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:133"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#6852841dbb53ef4979d329bd0dda4698"><span class="id" title="variable">γ1</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t1:134"><span class="id" title="variable">t1</span></a><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#4e97cf452882dc3f98e0131fef8d7935"><span class="id" title="notation">⟼*</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#e79e1c459cbcefc74bb95f284a781f87"><span class="id" title="variable">γ2</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t2:135"><span class="id" title="variable">t2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∃</span> <a id="c18690e10e13f8d3f76c5fdb20a83267" class="idref" href="#c18690e10e13f8d3f76c5fdb20a83267"><span class="id" title="binder">γ3</span></a> <a id="t3:140" class="idref" href="#t3:140"><span class="id" title="binder">t3</span></a> <a id="G3:141" class="idref" href="#G3:141"><span class="id" title="binder">G3</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#e79e1c459cbcefc74bb95f284a781f87"><span class="id" title="variable">γ2</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t2:135"><span class="id" title="variable">t2</span></a><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#6a0a2cd1c1d834551a7de9c07376fb83"><span class="id" title="notation">⟼</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#c18690e10e13f8d3f76c5fdb20a83267"><span class="id" title="variable">γ3</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t3:140"><span class="id" title="variable">t3</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G3:141"><span class="id" title="variable">G3</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t3:140"><span class="id" title="variable">t3</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:138"><span class="id" title="variable">T</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#c18690e10e13f8d3f76c5fdb20a83267"><span class="id" title="variable">γ3</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G3:141"><span class="id" title="variable">G3</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G3:141"><span class="id" title="variable">G3</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G3:141"><span class="id" title="variable">G3</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∨</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∃</span> <a id="G2:142" class="idref" href="#G2:142"><span class="id" title="binder">G2</span></a><span class="id" title="notation">,</span> <a class="idref" href="Reduction.html#norm_form"><span class="id" title="inductive">norm_form</span></a> <a class="idref" href="Safety.html#e79e1c459cbcefc74bb95f284a781f87"><span class="id" title="variable">γ2</span></a> <a class="idref" href="Safety.html#t2:135"><span class="id" title="variable">t2</span></a> <span class="id" title="notation">∧</span> <a class="idref" href="Safety.html#G2:142"><span class="id" title="variable">G2</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t2:135"><span class="id" title="variable">t2</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:138"><span class="id" title="variable">T</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#e79e1c459cbcefc74bb95f284a781f87"><span class="id" title="variable">γ2</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G2:142"><span class="id" title="variable">G2</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G2:142"><span class="id" title="variable">G2</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G2:142"><span class="id" title="variable">G2</span></a><span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hr</span>. <span class="id" title="var">gen</span> <span class="id" title="var">G</span> <span class="id" title="var">T</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">Hr</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span>; <span class="id" title="var">introv</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#progress"><span class="id" title="lemma">progress</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Ht</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hn</span> | [<span class="id" title="var">γ'</span> [<span class="id" title="var">t'</span> <span class="id" title="var">Hr</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">G</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#preservation"><span class="id" title="lemma">preservation</span></a> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Ht</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">G'</span> [<span class="id" title="var">Hi'</span> [<span class="id" title="var">Hwf'</span> [<span class="id" title="var">Hwt'</span> <span class="id" title="var">Ht'</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">γ'</span> <span class="id" title="var">t'</span> (<span class="id" title="var">G</span> <span class="id" title="notation">&amp;</span> <span class="id" title="var">G'</span>). <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>×. <span class="id" title="tactic">apply</span>× <a class="idref" href="RecordAndInertTypes.html#inert_concat"><span class="id" title="lemma">inert_concat</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">γ12</span> <span class="id" title="var">t12</span>]. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="constructor">eq_refl</span> <span class="id" title="constructor">eq_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#preservation"><span class="id" title="lemma">preservation</span></a> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">H</span> <span class="id" title="var">Ht</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">G'</span> [<span class="id" title="var">Hi'</span> [<span class="id" title="var">Hwf'</span> [<span class="id" title="var">Hwt'</span> <span class="id" title="var">Ht'</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHr</span> <span class="id" title="var">_</span> (<a class="idref" href="RecordAndInertTypes.html#inert_concat"><span class="id" title="lemma">inert_concat</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hi'</span> (<a class="idref" href="Binding.html#well_typed_to_ok_G"><span class="id" title="lemma">well_typed_to_ok_G</span></a> <span class="id" title="var">Hwt'</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="diverges" class="idref" href="#diverges"><span class="id" title="definition">diverges</span></a> := <a class="idref" href="Sequences.html#infseq"><span class="id" title="inductive">infseq</span></a> <a class="idref" href="Reduction.html#red"><span class="id" title="inductive">red</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="cyclic_path" class="idref" href="#cyclic_path"><span class="id" title="definition">cyclic_path</span></a> <a id="93fc82f4f76469c8d7ac12f1413de1af" class="idref" href="#93fc82f4f76469c8d7ac12f1413de1af"><span class="id" title="binder">γ</span></a> <a id="p:144" class="idref" href="#p:144"><span class="id" title="binder">p</span></a> := <a class="idref" href="Sequences.html#infseq"><span class="id" title="inductive">infseq</span></a> (<a class="idref" href="Lookup.html#lookup_step"><span class="id" title="inductive">lookup_step</span></a> <a class="idref" href="Safety.html#93fc82f4f76469c8d7ac12f1413de1af"><span class="id" title="variable">γ</span></a>) (<a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> <a class="idref" href="Safety.html#p:144"><span class="id" title="variable">p</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab98"></a><h4 class="section">Type Soundness (Theorem 4.1)</h4>
 Reducing any well-typed program (i.e. term that can be typed in an empty context)
    results either
<ul class="doclist">
<li> in a normal form (i.e. path or value) in a finite number of steps,

</li>
<li> in an infinite reduction sequence. 

</li>
</ul>
</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="safety" class="idref" href="#safety"><span class="id" title="lemma">safety</span></a> <a id="t:145" class="idref" href="#t:145"><span class="id" title="binder">t</span></a> <a id="T:146" class="idref" href="#T:146"><span class="id" title="binder">T</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t:145"><span class="id" title="variable">t</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:146"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;<a class="idref" href="Safety.html#diverges"><span class="id" title="definition">diverges</span></a> <span class="id" title="notation">(</span><span class="id" title="axiom">empty</span><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:145"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∨</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∃</span> <a id="fe5ea999c095efdc98fc485770ac68d4" class="idref" href="#fe5ea999c095efdc98fc485770ac68d4"><span class="id" title="binder">γ</span></a> <a id="u:148" class="idref" href="#u:148"><span class="id" title="binder">u</span></a> <a id="G:149" class="idref" href="#G:149"><span class="id" title="binder">G</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="axiom">empty</span><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:145"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#4e97cf452882dc3f98e0131fef8d7935"><span class="id" title="notation">⟼*</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#fe5ea999c095efdc98fc485770ac68d4"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#u:148"><span class="id" title="variable">u</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Reduction.html#norm_form"><span class="id" title="inductive">norm_form</span></a> <a class="idref" href="Safety.html#fe5ea999c095efdc98fc485770ac68d4"><span class="id" title="variable">γ</span></a> <a class="idref" href="Safety.html#u:148"><span class="id" title="variable">u</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:149"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#u:148"><span class="id" title="variable">u</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:146"><span class="id" title="variable">T</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#fe5ea999c095efdc98fc485770ac68d4"><span class="id" title="variable">γ</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:149"><span class="id" title="variable">G</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:149"><span class="id" title="variable">G</span></a> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:149"><span class="id" title="variable">G</span></a><span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Sequences.html#infseq_or_finseq"><span class="id" title="lemma">infseq_or_finseq</span></a> <a class="idref" href="Reduction.html#red"><span class="id" title="inductive">red</span></a> <span class="id" title="notation">(</span><span class="id" title="axiom">empty</span><span class="id" title="notation">,</span> <span class="id" title="var">t</span><span class="id" title="notation">)</span>) <span class="id" title="keyword">as</span> [? | [[<span class="id" title="var">s</span> <span class="id" title="var">u</span>] [<span class="id" title="var">Hr</span> <span class="id" title="var">Hn</span>]]]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#safety_helper"><span class="id" title="lemma">safety_helper</span></a> <span class="id" title="var">Ht</span> <a class="idref" href="Definitions.html#inert_empty"><span class="id" title="constructor">inert_empty</span></a> <a class="idref" href="PreciseTyping.html#wfe_empty"><span class="id" title="constructor">wfe_empty</span></a> <a class="idref" href="Definitions.html#well_typed_empty"><span class="id" title="constructor">well_typed_empty</span></a> <span class="id" title="var">Hr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [[<span class="id" title="var">γ'</span> [<span class="id" title="var">t'</span> [<span class="id" title="var">G'</span> [<span class="id" title="var">Hr'</span> [<span class="id" title="var">Ht'</span> <span class="id" title="var">Hwt</span>]]]]] | [<span class="id" title="var">G</span> [<span class="id" title="var">Hn'</span> [<span class="id" title="var">Ht'</span> [<span class="id" title="var">Hwt</span> [<span class="id" title="var">Hwf</span> <span class="id" title="var">Hi</span>]]]]]].<br/>
&nbsp;&nbsp;- <span class="id" title="var">false</span>× <span class="id" title="var">Hn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Safety.html#Safety"><span class="id" title="section">Safety</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab99"></a><h2 class="section">Safety wrt Path Lookup ⤳</h2>

</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a id="PathSafety" class="idref" href="#PathSafety"><span class="id" title="section">PathSafety</span></a>.<br/>

<br/>
</div>

<div class="doc">
Looking up any well-typed path in the value environment results either
<ul class="doclist">
<li> in a value in a finite number of steps, or

</li>
<li> in an infinite sequence of lookup operations, i.e. the path is cyclic 

</li>
</ul>
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="path_safety" class="idref" href="#path_safety"><span class="id" title="lemma">path_safety</span></a> <a id="G:150" class="idref" href="#G:150"><span class="id" title="binder">G</span></a> <a id="p:151" class="idref" href="#p:151"><span class="id" title="binder">p</span></a> <a id="T:152" class="idref" href="#T:152"><span class="id" title="binder">T</span></a> <a id="c0cf1192a15b70a4d629eff36d8e0c8c" class="idref" href="#c0cf1192a15b70a4d629eff36d8e0c8c"><span class="id" title="binder">γ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Definitions.html#inert"><span class="id" title="inductive">inert</span></a> <a class="idref" href="Safety.html#G:150"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PreciseTyping.html#wf"><span class="id" title="inductive">wf</span></a> <a class="idref" href="Safety.html#G:150"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#c0cf1192a15b70a4d629eff36d8e0c8c"><span class="id" title="variable">γ</span></a> <a class="idref" href="Definitions.html#3d0e0e057bcbfdd590f754a27815747e"><span class="id" title="notation">⫶</span></a> <a class="idref" href="Safety.html#G:150"><span class="id" title="variable">G</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#G:150"><span class="id" title="variable">G</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#p:151"><span class="id" title="variable">p</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:152"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#cyclic_path"><span class="id" title="definition">cyclic_path</span></a> <a class="idref" href="Safety.html#c0cf1192a15b70a4d629eff36d8e0c8c"><span class="id" title="variable">γ</span></a> <a class="idref" href="Safety.html#p:151"><span class="id" title="variable">p</span></a> <span class="id" title="notation">∨</span> <span class="id" title="notation">∃</span> <a id="v:154" class="idref" href="#v:154"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#c0cf1192a15b70a4d629eff36d8e0c8c"><span class="id" title="variable">γ</span></a> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟦</span></a> <a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> <a class="idref" href="Safety.html#p:151"><span class="id" title="variable">p</span></a> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⤳*</span></a> <a class="idref" href="Definitions.html#defv"><span class="id" title="constructor">defv</span></a> <a class="idref" href="Safety.html#v:154"><span class="id" title="variable">v</span></a> <a class="idref" href="Lookup.html#ec3bbb547a98649fb30ac24026f522c9"><span class="id" title="notation">⟧</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">proof_recipe</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="ReplacementTyping.html#repl_prec_exists"><span class="id" title="lemma">repl_prec_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">U</span> <span class="id" title="var">Hp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Sequences.html#infseq_or_finseq"><span class="id" title="lemma">infseq_or_finseq</span></a> (<a class="idref" href="Lookup.html#lookup_step"><span class="id" title="inductive">lookup_step</span></a> <span class="id" title="var">γ</span>) (<a class="idref" href="Definitions.html#defp"><span class="id" title="constructor">defp</span></a> <span class="id" title="var">p</span>)) <span class="id" title="keyword">as</span> [? | [<span class="id" title="var">t</span> [<span class="id" title="var">Hl</span> <span class="id" title="var">Hirr</span>]]]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="CanonicalForms.html#lookup_pres"><span class="id" title="lemma">lookup_pres</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hp</span> <span class="id" title="var">Hl</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">S</span> <span class="id" title="var">Hq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="CanonicalForms.html#typ_to_lookup3"><span class="id" title="lemma">typ_to_lookup3</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hl'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">false</span>× <span class="id" title="var">Hirr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Safety.html#PathSafety"><span class="id" title="section">PathSafety</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab100"></a><h2 class="section">Extended Safety</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a id="ExtendedSafety" class="idref" href="#ExtendedSafety"><span class="id" title="section">ExtendedSafety</span></a>.<br/>

<br/>
</div>

<div class="doc">
Extended reduction relation (combines term reduction ⟼ and lookup ⤳) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Reserved Notation</span> &quot;t '↠' u" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <a id="extended_red" class="idref" href="#extended_red"><span class="id" title="inductive">extended_red</span></a> : <a class="idref" href="Definitions.html#sta"><span class="id" title="definition">sta</span></a> <span class="id" title="notation">×</span> <a class="idref" href="Definitions.html#trm"><span class="id" title="inductive">trm</span></a> <span class="id" title="notation">→</span> <a class="idref" href="Definitions.html#sta"><span class="id" title="definition">sta</span></a> <span class="id" title="notation">×</span> <a class="idref" href="Definitions.html#trm"><span class="id" title="inductive">trm</span></a> <span class="id" title="notation">→</span> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="er_red" class="idref" href="#er_red"><span class="id" title="constructor">er_red</span></a> <a id="fd598c17e951b27256567704ec56c4a0" class="idref" href="#fd598c17e951b27256567704ec56c4a0"><span class="id" title="binder">γ</span></a> <a id="cc25c4aeebb98d7d49d30136a41026a5" class="idref" href="#cc25c4aeebb98d7d49d30136a41026a5"><span class="id" title="binder">γ'</span></a> <a id="t:159" class="idref" href="#t:159"><span class="id" title="binder">t</span></a> <a id="t':160" class="idref" href="#t':160"><span class="id" title="binder">t'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#fd598c17e951b27256567704ec56c4a0"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:159"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#6a0a2cd1c1d834551a7de9c07376fb83"><span class="id" title="notation">⟼</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#cc25c4aeebb98d7d49d30136a41026a5"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':160"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#fd598c17e951b27256567704ec56c4a0"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:159"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Safety.html#35871d9392fc195d2656f8da3ef0d8b5"><span class="id" title="notation">↠</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#cc25c4aeebb98d7d49d30136a41026a5"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':160"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;| <a id="er_lookup" class="idref" href="#er_lookup"><span class="id" title="constructor">er_lookup</span></a> <a id="9a90ce36b46f1a3024341e8fc68fb909" class="idref" href="#9a90ce36b46f1a3024341e8fc68fb909"><span class="id" title="binder">γ</span></a> <a id="p:162" class="idref" href="#p:162"><span class="id" title="binder">p</span></a> <a id="t:163" class="idref" href="#t:163"><span class="id" title="binder">t</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#9a90ce36b46f1a3024341e8fc68fb909"><span class="id" title="variable">γ</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⟦</span></a> <a class="idref" href="Safety.html#p:162"><span class="id" title="variable">p</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⤳</span></a> <a class="idref" href="Safety.html#t:163"><span class="id" title="variable">t</span></a> <a class="idref" href="Lookup.html#8cc79fc5d6dbc3a1ff519f58bcbc908b"><span class="id" title="notation">⟧</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#9a90ce36b46f1a3024341e8fc68fb909"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <a class="idref" href="Safety.html#p:162"><span class="id" title="variable">p</span></a><span class="id" title="notation">)</span> <a class="idref" href="Safety.html#35871d9392fc195d2656f8da3ef0d8b5"><span class="id" title="notation">↠</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#9a90ce36b46f1a3024341e8fc68fb909"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="CanonicalForms.html#deftrm"><span class="id" title="definition">deftrm</span></a> <a class="idref" href="Safety.html#t:163"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> <a id="35871d9392fc195d2656f8da3ef0d8b5" class="idref" href="#35871d9392fc195d2656f8da3ef0d8b5"><span class="id" title="notation">&quot;</span></a>t ↠ u" := (<a class="idref" href="Safety.html#extended_red:156"><span class="id" title="inductive">extended_red</span></a> <span class="id" title="var">t</span> <span class="id" title="var">u</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Safety.html#extended_red"><span class="id" title="inductive">extended_red</span></a>.<br/>

<br/>
</div>

<div class="doc">
Reflexive transitive closure of extended reduction 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="aa4e039642baffeef8eeffaf4ec5e4df" class="idref" href="#aa4e039642baffeef8eeffaf4ec5e4df"><span class="id" title="notation">&quot;</span></a>t '↠*' u" := ((<a class="idref" href="Sequences.html#star"><span class="id" title="inductive">star</span></a> <a class="idref" href="Safety.html#extended_red"><span class="id" title="inductive">extended_red</span></a>) <span class="id" title="var">t</span> <span class="id" title="var">u</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/>

<br/>
</div>

<div class="doc">
Divergence of extended reduction 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="diverges'" class="idref" href="#diverges'"><span class="id" title="definition">diverges'</span></a> := <a class="idref" href="Sequences.html#infseq"><span class="id" title="inductive">infseq</span></a> <a class="idref" href="Safety.html#extended_red"><span class="id" title="inductive">extended_red</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="extend_infseq" class="idref" href="#extend_infseq"><span class="id" title="lemma">extend_infseq</span></a> <a id="549a8720632aec802a7c365f05a21f68" class="idref" href="#549a8720632aec802a7c365f05a21f68"><span class="id" title="binder">γ</span></a> <a id="t:165" class="idref" href="#t:165"><span class="id" title="binder">t</span></a> <a id="3e78403e8454c8204c4b4136dda548bf" class="idref" href="#3e78403e8454c8204c4b4136dda548bf"><span class="id" title="binder">γ'</span></a> <a id="t':167" class="idref" href="#t':167"><span class="id" title="binder">t'</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#diverges'"><span class="id" title="definition">diverges'</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#549a8720632aec802a7c365f05a21f68"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:165"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#3e78403e8454c8204c4b4136dda548bf"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':167"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span> <a class="idref" href="Safety.html#aa4e039642baffeef8eeffaf4ec5e4df"><span class="id" title="notation">↠*</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#549a8720632aec802a7c365f05a21f68"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:165"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#diverges'"><span class="id" title="definition">diverges'</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#3e78403e8454c8204c4b4136dda548bf"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':167"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinf</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">Hr</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hinf</span> <span class="id" title="constructor">eq_refl</span> <span class="id" title="constructor">eq_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_red_extend" class="idref" href="#map_red_extend"><span class="id" title="lemma">map_red_extend</span></a> <a id="e02a02a41db3ea9aa306070ba27dc32c" class="idref" href="#e02a02a41db3ea9aa306070ba27dc32c"><span class="id" title="binder">γ</span></a> <a id="t:169" class="idref" href="#t:169"><span class="id" title="binder">t</span></a> <a id="5ae69a28c5e5166377f724c2561b691e" class="idref" href="#5ae69a28c5e5166377f724c2561b691e"><span class="id" title="binder">γ'</span></a> <a id="t':171" class="idref" href="#t':171"><span class="id" title="binder">t'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#e02a02a41db3ea9aa306070ba27dc32c"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:169"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Reduction.html#4e97cf452882dc3f98e0131fef8d7935"><span class="id" title="notation">⟼*</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#5ae69a28c5e5166377f724c2561b691e"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':171"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#e02a02a41db3ea9aa306070ba27dc32c"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:169"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Safety.html#aa4e039642baffeef8eeffaf4ec5e4df"><span class="id" title="notation">↠*</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#5ae69a28c5e5166377f724c2561b691e"><span class="id" title="variable">γ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t':171"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">Hr</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_lookup_extend" class="idref" href="#map_lookup_extend"><span class="id" title="lemma">map_lookup_extend</span></a> <a id="6e8d753e27180285700541751d2c98b8" class="idref" href="#6e8d753e27180285700541751d2c98b8"><span class="id" title="binder">γ</span></a> <a id="t:173" class="idref" href="#t:173"><span class="id" title="binder">t</span></a> <a id="t':174" class="idref" href="#t':174"><span class="id" title="binder">t'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Sequences.html#star"><span class="id" title="inductive">star</span></a> (<a class="idref" href="Lookup.html#lookup_step"><span class="id" title="inductive">lookup_step</span></a> <a class="idref" href="Safety.html#6e8d753e27180285700541751d2c98b8"><span class="id" title="variable">γ</span></a>) <a class="idref" href="Safety.html#t:173"><span class="id" title="variable">t</span></a> <a class="idref" href="Safety.html#t':174"><span class="id" title="variable">t'</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="Safety.html#6e8d753e27180285700541751d2c98b8"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="CanonicalForms.html#deftrm"><span class="id" title="definition">deftrm</span></a> <a class="idref" href="Safety.html#t:173"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Safety.html#aa4e039642baffeef8eeffaf4ec5e4df"><span class="id" title="notation">↠*</span></a><span class="id" title="notation">(</span><a class="idref" href="Safety.html#6e8d753e27180285700541751d2c98b8"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="CanonicalForms.html#deftrm"><span class="id" title="definition">deftrm</span></a> <a class="idref" href="Safety.html#t':174"><span class="id" title="variable">t'</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">Hr</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Sequences.html#star_trans"><span class="id" title="lemma">star_trans</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#star_one"><span class="id" title="lemma">star_one</span></a>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#er_lookup"><span class="id" title="constructor">er_lookup</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab101"></a><h4 class="section">Extended Soundness (Theorem 5.2)</h4>
 Reducing any well-typed program (i.e. term that can be typed in an empty context)
      using the extended reduction relation (that includes term reduction and path lookup)
      results either
<ul class="doclist">
<li> in a value in a finite number of steps, or

</li>
<li> in an infinite reduction sequence. 

</li>
</ul>
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a id="extended_safety" class="idref" href="#extended_safety"><span class="id" title="lemma">extended_safety</span></a> <a id="t:175" class="idref" href="#t:175"><span class="id" title="binder">t</span></a> <a id="T:176" class="idref" href="#T:176"><span class="id" title="binder">T</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">empty</span> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">⊢</span></a> <a class="idref" href="Safety.html#t:175"><span class="id" title="variable">t</span></a> <a class="idref" href="Definitions.html#8f800003c5c18bd4e5a8078841b62512"><span class="id" title="notation">:</span></a> <a class="idref" href="Safety.html#T:176"><span class="id" title="variable">T</span></a> <span class="id" title="notation">→</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#diverges'"><span class="id" title="definition">diverges'</span></a> <span class="id" title="notation">(</span><span class="id" title="axiom">empty</span><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:175"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∨</span> <span class="id" title="notation">∃</span> <a id="d3619922e9ded78cca017f7b15aea92e" class="idref" href="#d3619922e9ded78cca017f7b15aea92e"><span class="id" title="binder">γ</span></a> <a id="v:178" class="idref" href="#v:178"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="axiom">empty</span><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t:175"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span> <a class="idref" href="Safety.html#aa4e039642baffeef8eeffaf4ec5e4df"><span class="id" title="notation">↠*</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#d3619922e9ded78cca017f7b15aea92e"><span class="id" title="variable">γ</span></a><span class="id" title="notation">,</span> <a class="idref" href="Definitions.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Safety.html#v:178"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#safety"><span class="id" title="lemma">safety</span></a> <span class="id" title="var">Ht</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hd</span> | [<span class="id" title="var">γ</span> [<span class="id" title="var">u</span> [<span class="id" title="var">G</span> [<span class="id" title="var">Hr</span> [<span class="id" title="var">Hn</span> [<span class="id" title="var">Hu</span> [<span class="id" title="var">Hwt</span> [<span class="id" title="var">Hwf</span> <span class="id" title="var">Hi</span>]]]]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">Case</span> "term diverges"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">Hd</span>. <span class="id" title="var">inversions</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#infseq_step"><span class="id" title="constructor">infseq_step</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">b</span>:=<span class="id" title="var">b</span>); <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b0</span>. <span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Safety.html#er_red"><span class="id" title="constructor">er_red</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#infseq_coinduction_principle"><span class="id" title="lemma">infseq_coinduction_principle</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X</span> := <span class="id" title="keyword">fun</span> <a id="st:182" class="idref" href="#st:182"><span class="id" title="binder">st</span></a> ⇒ <span class="id" title="notation">∃</span> <a id="36b0adae9618486d592df2a5e2089606" class="idref" href="#36b0adae9618486d592df2a5e2089606"><span class="id" title="binder">γ1</span></a> <a id="t1:184" class="idref" href="#t1:184"><span class="id" title="binder">t1</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Safety.html#st:179"><span class="id" title="variable">st</span></a> <span class="id" title="notation">=</span> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#734680754ee2fa9bf618959809fd64a5"><span class="id" title="variable">γ1</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t1:181"><span class="id" title="variable">t1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span> <a class="idref" href="Sequences.html#infseq"><span class="id" title="inductive">infseq</span></a> <a class="idref" href="Reduction.html#red"><span class="id" title="inductive">red</span></a> <span class="id" title="notation">(</span><a class="idref" href="Safety.html#734680754ee2fa9bf618959809fd64a5"><span class="id" title="variable">γ1</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#t1:181"><span class="id" title="variable">t1</span></a><span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">st</span> [<span class="id" title="var">γ'</span> [<span class="id" title="var">t'</span> [-&gt; <span class="id" title="var">Hinf</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">inversions</span> <span class="id" title="var">Hinf</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span>×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">Case</span> "term evaluates to normal form"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">SCase</span> "term evaluates to a path"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="Safety.html#path_safety"><span class="id" title="lemma">path_safety</span></a> <span class="id" title="var">Hi</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hu</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hd</span> | <span class="id" title="var">Hn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">SSCase</span> "path lookup diverges"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">assert</span> (<a class="idref" href="Sequences.html#infseq"><span class="id" title="inductive">infseq</span></a> <a class="idref" href="Safety.html#extended_red"><span class="id" title="inductive">extended_red</span></a> <span class="id" title="notation">(</span><span class="id" title="var">γ</span><span class="id" title="notation">,</span> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <span class="id" title="var">p</span><span class="id" title="notation">)</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hwf</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hu</span> <span class="id" title="var">Ht</span> <span class="id" title="var">Hi</span> <span class="id" title="var">G</span> <span class="id" title="var">T</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Sequences.html#infseq_coinduction_principle"><span class="id" title="lemma">infseq_coinduction_principle</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X</span> := <span class="id" title="keyword">fun</span> <a id="st:187" class="idref" href="#st:187"><span class="id" title="binder">st</span></a> ⇒ <span class="id" title="notation">∃</span> <a id="u:188" class="idref" href="#u:188"><span class="id" title="binder">u</span></a><span class="id" title="notation">,</span> <a class="idref" href="Safety.html#st:185"><span class="id" title="variable">st</span></a> <span class="id" title="notation">=</span> <span class="id" title="notation">(</span><span class="id" title="var">γ</span><span class="id" title="notation">,</span> <a class="idref" href="CanonicalForms.html#deftrm"><span class="id" title="definition">deftrm</span></a> <a class="idref" href="Safety.html#u:186"><span class="id" title="variable">u</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span> <a class="idref" href="Sequences.html#infseq"><span class="id" title="inductive">infseq</span></a> (<a class="idref" href="Lookup.html#lookup_step"><span class="id" title="inductive">lookup_step</span></a> <span class="id" title="var">γ</span>) <a class="idref" href="Safety.html#u:186"><span class="id" title="variable">u</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">st</span> [<span class="id" title="var">du</span> [-&gt; <span class="id" title="var">Hinf</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">Hinf</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>, <span class="id" title="var">du</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span>*; <span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#er_lookup"><span class="id" title="constructor">er_lookup</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inversions</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>. <span class="id" title="var">false</span>× <a class="idref" href="Lookup.html#lookup_irred"><span class="id" title="lemma">lookup_irred</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">false</span>× <a class="idref" href="Lookup.html#lookup_irred"><span class="id" title="lemma">lookup_irred</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>×. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="Sequences.html#star"><span class="id" title="inductive">star</span></a> <a class="idref" href="Safety.html#extended_red"><span class="id" title="inductive">extended_red</span></a> <span class="id" title="notation">(</span><span class="id" title="axiom">empty</span><span class="id" title="notation">,</span> <span class="id" title="var">t</span><span class="id" title="notation">)</span> <span class="id" title="notation">(</span><span class="id" title="var">γ</span><span class="id" title="notation">,</span> <a class="idref" href="Definitions.html#trm_path"><span class="id" title="constructor">trm_path</span></a> <span class="id" title="var">p</span><span class="id" title="notation">)</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#map_red_extend"><span class="id" title="lemma">map_red_extend</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#extend_infseq"><span class="id" title="lemma">extend_infseq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">SSCase</span> "path looks up to value"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hn</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">Hv</span>]. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">γ</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Sequences.html#star_trans"><span class="id" title="lemma">star_trans</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="Safety.html#map_red_extend"><span class="id" title="lemma">map_red_extend</span></a>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Safety.html#map_lookup_extend"><span class="id" title="lemma">map_lookup_extend</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">SCase</span> "term evaluates to a value"%<span class="id" title="var">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">γ</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">apply</span>× <a class="idref" href="Safety.html#map_red_extend"><span class="id" title="lemma">map_red_extend</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Safety.html#ExtendedSafety"><span class="id" title="section">ExtendedSafety</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
